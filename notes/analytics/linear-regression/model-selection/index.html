<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yang Chen">
<meta name="dcterms.date" content="2023-07-07">

<title>Yang MSA - Model Selection</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<link href="../../../../favicon.ico" rel="icon">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">Yang MSA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../notes/index.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/yangrchen"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Model Selection</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">modeling</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Yang Chen </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 7, 2023</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">July 23, 2023</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#model-building-concepts" id="toc-model-building-concepts" class="nav-link active" data-scroll-target="#model-building-concepts"><span class="header-section-number">1</span> Model Building Concepts</a></li>
  <li><a href="#fear-of-overfitting" id="toc-fear-of-overfitting" class="nav-link" data-scroll-target="#fear-of-overfitting"><span class="header-section-number">2</span> Fear of Overfitting</a></li>
  <li><a href="#information-criteria" id="toc-information-criteria" class="nav-link" data-scroll-target="#information-criteria"><span class="header-section-number">3</span> Information Criteria</a>
  <ul class="collapse">
  <li><a href="#akaike-information-criterion" id="toc-akaike-information-criterion" class="nav-link" data-scroll-target="#akaike-information-criterion"><span class="header-section-number">3.1</span> Akaike Information Criterion</a></li>
  <li><a href="#bayesian-information-criterion" id="toc-bayesian-information-criterion" class="nav-link" data-scroll-target="#bayesian-information-criterion"><span class="header-section-number">3.2</span> Bayesian Information Criterion</a></li>
  </ul></li>
  <li><a href="#forward-selection" id="toc-forward-selection" class="nav-link" data-scroll-target="#forward-selection"><span class="header-section-number">4</span> Forward Selection</a>
  <ul class="collapse">
  <li><a href="#r-code" id="toc-r-code" class="nav-link" data-scroll-target="#r-code"><span class="header-section-number">4.1</span> R Code</a></li>
  <li><a href="#python-code" id="toc-python-code" class="nav-link" data-scroll-target="#python-code"><span class="header-section-number">4.2</span> Python Code</a></li>
  <li><a href="#other-criteria" id="toc-other-criteria" class="nav-link" data-scroll-target="#other-criteria"><span class="header-section-number">4.3</span> Other Criteria</a></li>
  </ul></li>
  <li><a href="#backward-selection" id="toc-backward-selection" class="nav-link" data-scroll-target="#backward-selection"><span class="header-section-number">5</span> Backward Selection</a>
  <ul class="collapse">
  <li><a href="#r-code-1" id="toc-r-code-1" class="nav-link" data-scroll-target="#r-code-1"><span class="header-section-number">5.1</span> R Code</a></li>
  </ul></li>
  <li><a href="#stepwise-selection" id="toc-stepwise-selection" class="nav-link" data-scroll-target="#stepwise-selection"><span class="header-section-number">6</span> Stepwise Selection</a>
  <ul class="collapse">
  <li><a href="#r-code-2" id="toc-r-code-2" class="nav-link" data-scroll-target="#r-code-2"><span class="header-section-number">6.1</span> R Code</a></li>
  </ul></li>
  <li><a href="#issues-with-automatic-search-algorithms" id="toc-issues-with-automatic-search-algorithms" class="nav-link" data-scroll-target="#issues-with-automatic-search-algorithms"><span class="header-section-number">7</span> Issues With Automatic Search Algorithms</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="model-building-concepts" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Model Building Concepts</h1>
<p><strong>Information criteria</strong> are metrics that are commonly used to “select” variables for the model.</p>
<p><strong>Selection algorithm</strong> is an automated technique to evaluate variables based on some selection criteria.</p>
<ul>
<li>Stepwise Selection (forward, backward, stepwise)</li>
<li>All-regression Selection (<span class="math inline">\(R^2\)</span>, <span class="math inline">\(R_a^2\)</span>, Mallow’s <span class="math inline">\(C_p\)</span>)</li>
</ul>
<p>All-regression selection tends to be unusable for datasets of a large size so we focus on stepwise selection for now.</p>
</section>
<section id="fear-of-overfitting" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Fear of Overfitting</h1>
<p>Model selection should always be done with training data.</p>
<p>Always hold out validation / testing data to help evaluate if we have overfit our data.</p>
</section>
<section id="information-criteria" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Information Criteria</h1>
<p>AIC and BIC approximate out-of-sample prediction error by applying a model complexity penalty.</p>
<p>Lower values are “better” than higher. No amount of lower is “better” enough.</p>
<p>The two criteria may not always agree, but neither is necessarily better.</p>
<section id="akaike-information-criterion" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="akaike-information-criterion"><span class="header-section-number">3.1</span> Akaike Information Criterion</h2>
<p><span class="math display">\[
AIC = -2\log(L) + 2k
\]</span></p>
<p>Crude, large-sample approximation of leave-one-out cross-validation.</p>
</section>
<section id="bayesian-information-criterion" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="bayesian-information-criterion"><span class="header-section-number">3.2</span> Bayesian Information Criterion</h2>
<p><span class="math display">\[
BIC = -2\log(L) + k\log(n)
\]</span></p>
<p>Favors smaller models and penalizes model complexity more.</p>
</section>
</section>
<section id="forward-selection" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Forward Selection</h1>
<p>Start with a “null” model (just the intercept) and build up the model one variable at a time.</p>
<ol type="1">
<li>Start with intercept only model</li>
<li>For each variable not in model, create a linear regression model with the base model plus this variable</li>
<li>See which linear regression is best relative to the criterion</li>
<li>If better than base model, continue. Otherwise, stop.</li>
<li>Update base model to new model, repeat whole process</li>
</ol>
<p>Once a variable enters the model in forward selection, the variable never leaves the model. This is a greedy algorithm so we might lose out on a better model since our initial decision on the best feature determines future decisions.</p>
<section id="r-code" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="r-code"><span class="header-section-number">4.1</span> R Code</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.2     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.1     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AmesHousing)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>ames <span class="ot">&lt;-</span> <span class="fu">make_ordinal_ames</span>()</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample_frac</span>(ames, <span class="fl">0.7</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>train_sel <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(Sale_Price, Lot_Area, Street, Bldg_Type, House_Style, Overall_Qual, Roof_Style, Central_Air, First_Flr_SF, Second_Flr_SF, Full_Bath, Half_Bath, Fireplaces, Garage_Area, Gr_Liv_Area, TotRms_AbvGrd) <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">replace</span>(<span class="fu">is.na</span>(.), <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> train_sel)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>empty.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sale_Price <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> train_sel)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>for.model <span class="ot">&lt;-</span> <span class="fu">step</span>(empty.model,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">scope =</span> <span class="fu">list</span>(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower =</span> empty.model,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> full.model</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"forward"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">2</span>,</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> <span class="cn">FALSE</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>for.model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sale_Price ~ Overall_Qual + Gr_Liv_Area + House_Style + 
    Garage_Area + Bldg_Type + Lot_Area + Fireplaces + Central_Air + 
    Roof_Style + Half_Bath + Full_Bath + First_Flr_SF + TotRms_AbvGrd + 
    Second_Flr_SF, data = train_sel)

Coefficients:
                (Intercept)               Overall_Qual.L  
                  49308.311                   226471.803  
             Overall_Qual.Q               Overall_Qual.C  
                  82180.741                    38253.369  
             Overall_Qual^4               Overall_Qual^5  
                 -16484.729                    -8753.436  
             Overall_Qual^6               Overall_Qual^7  
                 -14290.374                     -557.745  
             Overall_Qual^8               Overall_Qual^9  
                  -2270.430                     -817.895  
                Gr_Liv_Area  House_StyleOne_and_Half_Unf  
                      7.251                     9702.783  
       House_StyleOne_Story            House_StyleSFoyer  
                  15666.481                    32716.305  
            House_StyleSLvl  House_StyleTwo_and_Half_Fin  
                   8472.968                    -4423.776  
House_StyleTwo_and_Half_Unf         House_StyleTwo_Story  
                 -10757.587                     5306.240  
                Garage_Area            Bldg_TypeTwoFmCon  
                     33.458                   -13910.202  
            Bldg_TypeDuplex               Bldg_TypeTwnhs  
                 -29913.678                   -11760.427  
            Bldg_TypeTwnhsE                     Lot_Area  
                  -5395.254                        0.579  
                 Fireplaces                 Central_AirY  
                   7424.436                    13095.719  
            Roof_StyleGable            Roof_StyleGambrel  
                  -8675.172                   -16732.110  
              Roof_StyleHip            Roof_StyleMansard  
                  -4868.546                   -59767.670  
             Roof_StyleShed                    Half_Bath  
                 -34105.646                     9907.065  
                  Full_Bath                 First_Flr_SF  
                   9811.399                       64.897  
              TotRms_AbvGrd                Second_Flr_SF  
                  -2503.751                       44.967  </code></pre>
</div>
</div>
<ul>
<li>Good practice to specify the full and empty models</li>
<li><code>k = 2</code> is selecting the AIC criteria</li>
</ul>
</section>
<section id="python-code" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="python-code"><span class="header-section-number">4.2</span> Python Code</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from sklearn.feature_selection import SequentialFeatureSelector</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># import statsmodels.formula.api as smf</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># model = </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The model obtained through forward selection is not necessarily a model where all variables are significant.</p>
</section>
<section id="other-criteria" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="other-criteria"><span class="header-section-number">4.3</span> Other Criteria</h2>
<p>Using <code>k = qchisq(0.05, 1, lower.tail = FALSE)</code> would replace the selection criteria with p-value selection. <span class="math inline">\(\alpha = 0.05\)</span> in this case.</p>
<p><code>k = log(nrow(train_sel))</code> would use the BIC criterion.</p>
</section>
</section>
<section id="backward-selection" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Backward Selection</h1>
<p>Remove variables in the model one at a time.</p>
<ol type="1">
<li>Start with full model with all variables</li>
<li>Create models such that each model has exactly one predictor variable removed from it and calculate the criterion for each model</li>
<li>See which linear regression is best based on criterion</li>
<li>If better than base, continue to next step otherwise STOP</li>
<li>Update base model to new model, repeat</li>
</ol>
<p>There are no guarantees that forward and back will agree.</p>
<section id="r-code-1" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="r-code-1"><span class="header-section-number">5.1</span> R Code</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> train_sel)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>empty.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sale_Price <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> train_sel)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>back.model <span class="ot">&lt;-</span> <span class="fu">step</span>(</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    full.model,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">scope =</span> <span class="fu">list</span>(</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower =</span> empty.model,</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> full.model</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"backward"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">2</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">trace =</span> <span class="cn">FALSE</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>back.model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Sale_Price ~ Lot_Area + Bldg_Type + House_Style + 
    Overall_Qual + Roof_Style + Central_Air + First_Flr_SF + 
    Second_Flr_SF + Full_Bath + Half_Bath + Fireplaces + Garage_Area + 
    TotRms_AbvGrd, data = train_sel)

Coefficients:
                (Intercept)                     Lot_Area  
                  4.955e+04                    5.791e-01  
          Bldg_TypeTwoFmCon              Bldg_TypeDuplex  
                 -1.398e+04                   -3.000e+04  
             Bldg_TypeTwnhs              Bldg_TypeTwnhsE  
                 -1.176e+04                   -5.378e+03  
House_StyleOne_and_Half_Unf         House_StyleOne_Story  
                  9.319e+03                    1.523e+04  
          House_StyleSFoyer              House_StyleSLvl  
                  3.235e+04                    8.129e+03  
House_StyleTwo_and_Half_Fin  House_StyleTwo_and_Half_Unf  
                 -1.700e+03                   -1.086e+04  
       House_StyleTwo_Story               Overall_Qual.L  
                  5.209e+03                    2.264e+05  
             Overall_Qual.Q               Overall_Qual.C  
                  8.228e+04                    3.833e+04  
             Overall_Qual^4               Overall_Qual^5  
                 -1.645e+04                   -8.733e+03  
             Overall_Qual^6               Overall_Qual^7  
                 -1.422e+04                   -5.365e+02  
             Overall_Qual^8               Overall_Qual^9  
                 -2.253e+03                   -8.077e+02  
            Roof_StyleGable            Roof_StyleGambrel  
                 -8.721e+03                   -1.689e+04  
              Roof_StyleHip            Roof_StyleMansard  
                 -4.914e+03                   -5.980e+04  
             Roof_StyleShed                 Central_AirY  
                 -3.409e+04                    1.311e+04  
               First_Flr_SF                Second_Flr_SF  
                  7.207e+01                    5.170e+01  
                  Full_Bath                    Half_Bath  
                  9.859e+03                    9.913e+03  
                 Fireplaces                  Garage_Area  
                  7.440e+03                    3.340e+01  
              TotRms_AbvGrd  
                 -2.452e+03  </code></pre>
</div>
</div>
<p>It’s good idea to perform different types of selection to get an idea of what features to include in your final model.</p>
</section>
</section>
<section id="stepwise-selection" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Stepwise Selection</h1>
<p>Start with “null” model and build the model one variable at a time while also deleting variables.</p>
<ol type="1">
<li>Start with intercept only model</li>
<li>For each variable not in model, create a linear regression model with base model plus this variable</li>
<li>For each variable, create models with the base model taking away one variable at a time</li>
<li>See which linear regression is best based on criterion</li>
<li>If better than base model, continue to next step, otherwise STOP</li>
<li>Update base model to new model, repeat process</li>
</ol>
<p>With stepwise, once you decide to delete a model you never add it back into your model again.</p>
<section id="r-code-2" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="r-code-2"><span class="header-section-number">6.1</span> R Code</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>full.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sale_Price <span class="sc">~</span> ., <span class="at">data =</span> train_sel)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>empty.model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Sale_Price <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> train_sel)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>step.model <span class="ot">&lt;-</span> <span class="fu">step</span>(empty.model,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">scope =</span> <span class="fu">list</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">lower =</span> empty.model,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">upper =</span> full.model</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">k =</span> <span class="dv">2</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=46387.11
Sale_Price ~ 1

                Df  Sum of Sq        RSS   AIC
+ Overall_Qual   9 9.6786e+12 3.9328e+12 43859
+ Gr_Liv_Area    1 7.0185e+12 6.5929e+12 44902
+ First_Flr_SF   1 5.9158e+12 7.6956e+12 45220
+ Garage_Area    1 5.7015e+12 7.9100e+12 45276
+ Full_Bath      1 4.0091e+12 9.6023e+12 45674
+ TotRms_AbvGrd  1 3.2798e+12 1.0332e+13 45824
+ Fireplaces     1 3.0429e+12 1.0569e+13 45870
+ Roof_Style     5 1.1930e+12 1.2418e+13 46209
+ Lot_Area       1 9.9240e+11 1.2619e+13 46234
+ Central_Air    1 8.9825e+11 1.2713e+13 46249
+ Half_Bath      1 8.6579e+11 1.2746e+13 46254
+ House_Style    7 9.1007e+11 1.2701e+13 46259
+ Second_Flr_SF  1 7.7180e+11 1.2840e+13 46269
+ Bldg_Type      4 5.0175e+11 1.3110e+13 46318
+ Street         1 2.5318e+10 1.3586e+13 46385
&lt;none&gt;                        1.3611e+13 46387

Step:  AIC=43858.69
Sale_Price ~ Overall_Qual

                Df  Sum of Sq        RSS   AIC
+ Gr_Liv_Area    1 1.1390e+12 2.7938e+12 43159
+ First_Flr_SF   1 8.2206e+11 3.1108e+12 43380
+ Garage_Area    1 5.0899e+11 3.4239e+12 43576
+ TotRms_AbvGrd  1 4.6679e+11 3.4661e+12 43602
+ Fireplaces     1 4.3575e+11 3.4971e+12 43620
+ Lot_Area       1 4.3156e+11 3.5013e+12 43622
+ Full_Bath      1 3.4238e+11 3.5905e+12 43674
+ Bldg_Type      4 2.1987e+11 3.7130e+12 43749
+ Second_Flr_SF  1 1.1069e+11 3.8222e+12 43802
+ Central_Air    1 1.0281e+11 3.8300e+12 43806
+ Half_Bath      1 9.6265e+10 3.8366e+12 43810
+ Roof_Style     5 9.8243e+10 3.8346e+12 43817
+ House_Style    7 5.3069e+10 3.8798e+12 43845
&lt;none&gt;                        3.9328e+12 43859
+ Street         1 6.5122e+07 3.9328e+12 43861
- Overall_Qual   9 9.6786e+12 1.3611e+13 46387

Step:  AIC=43159.35
Sale_Price ~ Overall_Qual + Gr_Liv_Area

                Df  Sum of Sq        RSS   AIC
+ House_Style    7 3.7094e+11 2.4229e+12 42881
+ First_Flr_SF   1 3.0997e+11 2.4839e+12 42920
+ Second_Flr_SF  1 2.7039e+11 2.5234e+12 42953
+ Garage_Area    1 2.5273e+11 2.5411e+12 42967
+ Lot_Area       1 1.6985e+11 2.6240e+12 43033
+ Fireplaces     1 1.3298e+11 2.6608e+12 43061
+ Central_Air    1 1.1378e+11 2.6800e+12 43076
+ Bldg_Type      4 1.0111e+11 2.6927e+12 43092
+ Roof_Style     5 8.3606e+10 2.7102e+12 43107
+ TotRms_AbvGrd  1 4.9729e+10 2.7441e+12 43125
+ Full_Bath      1 5.0158e+09 2.7888e+12 43158
+ Half_Bath      1 4.2670e+09 2.7896e+12 43158
&lt;none&gt;                        2.7938e+12 43159
+ Street         1 3.0361e+08 2.7935e+12 43161
- Gr_Liv_Area    1 1.1390e+12 3.9328e+12 43859
- Overall_Qual   9 3.7991e+12 6.5929e+12 44902

Step:  AIC=42881.18
Sale_Price ~ Overall_Qual + Gr_Liv_Area + House_Style

                Df  Sum of Sq        RSS   AIC
+ Garage_Area    1 1.2429e+11 2.2986e+12 42775
+ Bldg_Type      4 1.1851e+11 2.3044e+12 42786
+ Lot_Area       1 9.0059e+10 2.3328e+12 42805
+ Fireplaces     1 7.3465e+10 2.3494e+12 42820
+ Central_Air    1 6.4141e+10 2.3587e+12 42828
+ Half_Bath      1 2.7168e+10 2.3957e+12 42860
+ TotRms_AbvGrd  1 2.4413e+10 2.3985e+12 42862
+ Roof_Style     5 3.1845e+10 2.3910e+12 42864
+ First_Flr_SF   1 2.1082e+10 2.4018e+12 42865
+ Second_Flr_SF  1 9.8702e+09 2.4130e+12 42875
&lt;none&gt;                        2.4229e+12 42881
+ Street         1 6.5162e+08 2.4222e+12 42883
+ Full_Bath      1 3.1011e+08 2.4226e+12 42883
- House_Style    7 3.7094e+11 2.7938e+12 43159
- Gr_Liv_Area    1 1.4569e+12 3.8798e+12 43845
- Overall_Qual   9 2.6563e+12 5.0792e+12 44381

Step:  AIC=42775.18
Sale_Price ~ Overall_Qual + Gr_Liv_Area + House_Style + Garage_Area

                Df  Sum of Sq        RSS   AIC
+ Bldg_Type      4 9.9484e+10 2.1991e+12 42692
+ Fireplaces     1 7.7120e+10 2.2215e+12 42707
+ Lot_Area       1 6.9201e+10 2.2294e+12 42714
+ Central_Air    1 4.0309e+10 2.2583e+12 42741
+ TotRms_AbvGrd  1 2.2264e+10 2.2763e+12 42757
+ Roof_Style     5 2.9837e+10 2.2688e+12 42758
+ Half_Bath      1 2.0578e+10 2.2780e+12 42759
+ First_Flr_SF   1 1.2447e+10 2.2862e+12 42766
+ Second_Flr_SF  1 5.2779e+09 2.2933e+12 42772
&lt;none&gt;                        2.2986e+12 42775
+ Street         1 4.8080e+07 2.2986e+12 42777
+ Full_Bath      1 1.8678e+07 2.2986e+12 42777
- Garage_Area    1 1.2429e+11 2.4229e+12 42881
- House_Style    7 2.4250e+11 2.5411e+12 42967
- Gr_Liv_Area    1 1.0810e+12 3.3796e+12 43564
- Overall_Qual   9 1.9714e+12 4.2700e+12 44027

Step:  AIC=42692.43
Sale_Price ~ Overall_Qual + Gr_Liv_Area + House_Style + Garage_Area + 
    Bldg_Type

                Df  Sum of Sq        RSS   AIC
+ Lot_Area       1 5.7797e+10 2.1413e+12 42640
+ Fireplaces     1 5.3007e+10 2.1461e+12 42644
+ Central_Air    1 2.6218e+10 2.1729e+12 42670
+ Roof_Style     5 2.9830e+10 2.1693e+12 42674
+ Half_Bath      1 1.8890e+10 2.1802e+12 42677
+ First_Flr_SF   1 1.7475e+10 2.1816e+12 42678
+ TotRms_AbvGrd  1 9.1215e+09 2.1900e+12 42686
+ Second_Flr_SF  1 7.9895e+09 2.1911e+12 42687
+ Full_Bath      1 6.1306e+09 2.1930e+12 42689
&lt;none&gt;                        2.1991e+12 42692
+ Street         1 3.5384e+08 2.1988e+12 42694
- Bldg_Type      4 9.9484e+10 2.2986e+12 42775
- Garage_Area    1 1.0526e+11 2.3044e+12 42786
- House_Style    7 2.6840e+11 2.4675e+12 42915
- Gr_Liv_Area    1 1.0416e+12 3.2408e+12 43486
- Overall_Qual   9 1.6326e+12 3.8317e+12 43813

Step:  AIC=42639.81
Sale_Price ~ Overall_Qual + Gr_Liv_Area + House_Style + Garage_Area + 
    Bldg_Type + Lot_Area

                Df  Sum of Sq        RSS   AIC
+ Fireplaces     1 4.0525e+10 2.1008e+12 42603
+ Central_Air    1 2.3631e+10 2.1177e+12 42619
+ Roof_Style     5 2.8521e+10 2.1128e+12 42622
+ Half_Bath      1 1.7687e+10 2.1236e+12 42625
+ First_Flr_SF   1 1.0898e+10 2.1304e+12 42631
+ Full_Bath      1 6.9609e+09 2.1344e+12 42635
+ TotRms_AbvGrd  1 6.8886e+09 2.1344e+12 42635
+ Second_Flr_SF  1 4.0098e+09 2.1373e+12 42638
&lt;none&gt;                        2.1413e+12 42640
+ Street         1 1.1335e+09 2.1402e+12 42641
- Lot_Area       1 5.7797e+10 2.1991e+12 42692
- Bldg_Type      4 8.8079e+10 2.2294e+12 42714
- Garage_Area    1 9.0624e+10 2.2319e+12 42723
- House_Style    7 2.2397e+11 2.3653e+12 42830
- Gr_Liv_Area    1 8.8831e+11 3.0296e+12 43350
- Overall_Qual   9 1.6705e+12 3.8118e+12 43805

Step:  AIC=42602.62
Sale_Price ~ Overall_Qual + Gr_Liv_Area + House_Style + Garage_Area + 
    Bldg_Type + Lot_Area + Fireplaces

                Df  Sum of Sq        RSS   AIC
+ Central_Air    1 2.0982e+10 2.0798e+12 42584
+ Roof_Style     5 2.5934e+10 2.0749e+12 42587
+ Half_Bath      1 1.3786e+10 2.0870e+12 42591
+ Full_Bath      1 1.2634e+10 2.0882e+12 42592
+ First_Flr_SF   1 7.9246e+09 2.0929e+12 42597
+ TotRms_AbvGrd  1 6.0760e+09 2.0947e+12 42599
+ Second_Flr_SF  1 2.4859e+09 2.0983e+12 42602
&lt;none&gt;                        2.1008e+12 42603
+ Street         1 1.3531e+09 2.0994e+12 42603
- Fireplaces     1 4.0525e+10 2.1413e+12 42640
- Lot_Area       1 4.5315e+10 2.1461e+12 42644
- Bldg_Type      4 6.8112e+10 2.1689e+12 42660
- Garage_Area    1 9.5457e+10 2.1963e+12 42692
- House_Style    7 1.9057e+11 2.2914e+12 42767
- Gr_Liv_Area    1 6.8568e+11 2.7865e+12 43180
- Overall_Qual   9 1.6377e+12 3.7385e+12 43767

Step:  AIC=42584.03
Sale_Price ~ Overall_Qual + Gr_Liv_Area + House_Style + Garage_Area + 
    Bldg_Type + Lot_Area + Fireplaces + Central_Air

                Df  Sum of Sq        RSS   AIC
+ Roof_Style     5 2.3879e+10 2.0559e+12 42570
+ Full_Bath      1 1.2884e+10 2.0669e+12 42573
+ Half_Bath      1 1.0579e+10 2.0692e+12 42576
+ First_Flr_SF   1 8.5564e+09 2.0713e+12 42578
+ TotRms_AbvGrd  1 6.7639e+09 2.0731e+12 42579
+ Second_Flr_SF  1 2.7821e+09 2.0770e+12 42583
&lt;none&gt;                        2.0798e+12 42584
+ Street         1 1.5371e+09 2.0783e+12 42585
- Central_Air    1 2.0982e+10 2.1008e+12 42603
- Fireplaces     1 3.7876e+10 2.1177e+12 42619
- Lot_Area       1 4.3536e+10 2.1234e+12 42625
- Bldg_Type      4 5.6366e+10 2.1362e+12 42631
- Garage_Area    1 8.0082e+10 2.1599e+12 42660
- House_Style    7 1.7426e+11 2.2541e+12 42735
- Gr_Liv_Area    1 6.7616e+11 2.7560e+12 43159
- Overall_Qual   9 1.6464e+12 3.7262e+12 43762

Step:  AIC=42570.35
Sale_Price ~ Overall_Qual + Gr_Liv_Area + House_Style + Garage_Area + 
    Bldg_Type + Lot_Area + Fireplaces + Central_Air + Roof_Style

                Df  Sum of Sq        RSS   AIC
+ Half_Bath      1 1.2657e+10 2.0433e+12 42560
+ Full_Bath      1 1.1807e+10 2.0441e+12 42561
+ First_Flr_SF   1 8.2634e+09 2.0477e+12 42564
+ TotRms_AbvGrd  1 7.5653e+09 2.0484e+12 42565
+ Second_Flr_SF  1 2.5689e+09 2.0534e+12 42570
&lt;none&gt;                        2.0559e+12 42570
+ Street         1 1.5834e+09 2.0544e+12 42571
- Roof_Style     5 2.3879e+10 2.0798e+12 42584
- Central_Air    1 1.8927e+10 2.0749e+12 42587
- Fireplaces     1 3.5505e+10 2.0914e+12 42603
- Lot_Area       1 4.3312e+10 2.0992e+12 42611
- Bldg_Type      4 5.7137e+10 2.1131e+12 42619
- Garage_Area    1 7.7724e+10 2.1337e+12 42644
- House_Style    7 1.5430e+11 2.2102e+12 42705
- Gr_Liv_Area    1 6.5674e+11 2.7127e+12 43137
- Overall_Qual   9 1.5782e+12 3.6341e+12 43721

Step:  AIC=42559.68
Sale_Price ~ Overall_Qual + Gr_Liv_Area + House_Style + Garage_Area + 
    Bldg_Type + Lot_Area + Fireplaces + Central_Air + Roof_Style + 
    Half_Bath

                Df  Sum of Sq        RSS   AIC
+ Full_Bath      1 2.2460e+10 2.0208e+12 42539
+ First_Flr_SF   1 1.1168e+10 2.0321e+12 42550
+ TotRms_AbvGrd  1 6.6957e+09 2.0366e+12 42555
+ Second_Flr_SF  1 4.4132e+09 2.0389e+12 42557
&lt;none&gt;                        2.0433e+12 42560
+ Street         1 1.6758e+09 2.0416e+12 42560
- Half_Bath      1 1.2657e+10 2.0559e+12 42570
- Central_Air    1 1.5721e+10 2.0590e+12 42573
- Roof_Style     5 2.5957e+10 2.0692e+12 42576
- Fireplaces     1 3.1983e+10 2.0753e+12 42590
- Lot_Area       1 4.2973e+10 2.0863e+12 42600
- Bldg_Type      4 5.7342e+10 2.1006e+12 42608
- Garage_Area    1 7.4966e+10 2.1182e+12 42632
- House_Style    7 1.6681e+11 2.2101e+12 42707
- Gr_Liv_Area    1 6.4712e+11 2.6904e+12 43122
- Overall_Qual   9 1.5761e+12 3.6194e+12 43714

Step:  AIC=42539.01
Sale_Price ~ Overall_Qual + Gr_Liv_Area + House_Style + Garage_Area + 
    Bldg_Type + Lot_Area + Fireplaces + Central_Air + Roof_Style + 
    Half_Bath + Full_Bath

                Df  Sum of Sq        RSS   AIC
+ First_Flr_SF   1 1.3554e+10 2.0073e+12 42527
+ TotRms_AbvGrd  1 7.9202e+09 2.0129e+12 42533
+ Second_Flr_SF  1 6.1295e+09 2.0147e+12 42535
&lt;none&gt;                        2.0208e+12 42539
+ Street         1 1.5161e+09 2.0193e+12 42539
- Central_Air    1 1.5081e+10 2.0359e+12 42552
- Roof_Style     5 2.5536e+10 2.0464e+12 42555
- Full_Bath      1 2.2460e+10 2.0433e+12 42560
- Half_Bath      1 2.3310e+10 2.0441e+12 42561
- Fireplaces     1 3.8140e+10 2.0590e+12 42575
- Lot_Area       1 4.2795e+10 2.0636e+12 42580
- Bldg_Type      4 7.0416e+10 2.0912e+12 42601
- Garage_Area    1 6.9447e+10 2.0903e+12 42606
- House_Style    7 1.7045e+11 2.1913e+12 42691
- Gr_Liv_Area    1 4.3760e+11 2.4584e+12 42939
- Overall_Qual   9 1.5073e+12 3.5281e+12 43664

Step:  AIC=42527.21
Sale_Price ~ Overall_Qual + Gr_Liv_Area + House_Style + Garage_Area + 
    Bldg_Type + Lot_Area + Fireplaces + Central_Air + Roof_Style + 
    Half_Bath + Full_Bath + First_Flr_SF

                Df  Sum of Sq        RSS   AIC
+ TotRms_AbvGrd  1 9.2160e+09 1.9980e+12 42520
+ Second_Flr_SF  1 8.9845e+09 1.9983e+12 42520
&lt;none&gt;                        2.0073e+12 42527
+ Street         1 1.4992e+09 2.0058e+12 42528
- First_Flr_SF   1 1.3554e+10 2.0208e+12 42539
- Central_Air    1 1.5279e+10 2.0225e+12 42541
- Roof_Style     5 2.5274e+10 2.0325e+12 42543
- Full_Bath      1 2.4846e+10 2.0321e+12 42550
- Half_Bath      1 2.8024e+10 2.0353e+12 42554
- Fireplaces     1 3.4393e+10 2.0417e+12 42560
- Lot_Area       1 3.7100e+10 2.0444e+12 42563
- House_Style    7 5.1979e+10 2.0592e+12 42566
- Garage_Area    1 6.1955e+10 2.0692e+12 42588
- Bldg_Type      4 7.5956e+10 2.0832e+12 42595
- Gr_Liv_Area    1 9.7174e+10 2.1044e+12 42622
- Overall_Qual   9 1.4420e+12 3.4493e+12 43620

Step:  AIC=42519.77
Sale_Price ~ Overall_Qual + Gr_Liv_Area + House_Style + Garage_Area + 
    Bldg_Type + Lot_Area + Fireplaces + Central_Air + Roof_Style + 
    Half_Bath + Full_Bath + First_Flr_SF + TotRms_AbvGrd

                Df  Sum of Sq        RSS   AIC
+ Second_Flr_SF  1 8.4078e+09 1.9896e+12 42513
&lt;none&gt;                        1.9980e+12 42520
+ Street         1 1.6201e+09 1.9964e+12 42520
- TotRms_AbvGrd  1 9.2160e+09 2.0073e+12 42527
- First_Flr_SF   1 1.4850e+10 2.0129e+12 42533
- Central_Air    1 1.6103e+10 2.0142e+12 42534
- Roof_Style     5 2.6015e+10 2.0241e+12 42536
- Full_Bath      1 2.6354e+10 2.0244e+12 42545
- Half_Bath      1 2.7318e+10 2.0254e+12 42546
- Fireplaces     1 3.3635e+10 2.0317e+12 42552
- House_Style    7 4.6648e+10 2.0447e+12 42553
- Lot_Area       1 3.5234e+10 2.0333e+12 42554
- Garage_Area    1 6.0006e+10 2.0581e+12 42578
- Bldg_Type      4 6.6554e+10 2.0646e+12 42579
- Gr_Liv_Area    1 1.0626e+11 2.1043e+12 42624
- Overall_Qual   9 1.4449e+12 3.4430e+12 43618

Step:  AIC=42513.12
Sale_Price ~ Overall_Qual + Gr_Liv_Area + House_Style + Garage_Area + 
    Bldg_Type + Lot_Area + Fireplaces + Central_Air + Roof_Style + 
    Half_Bath + Full_Bath + First_Flr_SF + TotRms_AbvGrd + Second_Flr_SF

                Df  Sum of Sq        RSS   AIC
- Gr_Liv_Area    1 2.0878e+08 1.9898e+12 42511
&lt;none&gt;                        1.9896e+12 42513
+ Street         1 1.6751e+09 1.9880e+12 42513
- Second_Flr_SF  1 8.4078e+09 1.9980e+12 42520
- TotRms_AbvGrd  1 8.6394e+09 1.9983e+12 42520
- First_Flr_SF   1 1.6139e+10 2.0058e+12 42528
- Central_Air    1 1.6361e+10 2.0060e+12 42528
- Roof_Style     5 2.6070e+10 2.0157e+12 42530
- Full_Bath      1 2.5226e+10 2.0149e+12 42537
- Half_Bath      1 2.5401e+10 2.0150e+12 42537
- House_Style    7 4.2545e+10 2.0322e+12 42543
- Fireplaces     1 3.3076e+10 2.0227e+12 42545
- Lot_Area       1 3.5199e+10 2.0248e+12 42547
- Garage_Area    1 5.8031e+10 2.0477e+12 42570
- Bldg_Type      4 6.7352e+10 2.0570e+12 42573
- Overall_Qual   9 1.4395e+12 3.4292e+12 43612

Step:  AIC=42511.34
Sale_Price ~ Overall_Qual + House_Style + Garage_Area + Bldg_Type + 
    Lot_Area + Fireplaces + Central_Air + Roof_Style + Half_Bath + 
    Full_Bath + First_Flr_SF + TotRms_AbvGrd + Second_Flr_SF

                Df  Sum of Sq        RSS   AIC
&lt;none&gt;                        1.9898e+12 42511
+ Street         1 1.6987e+09 1.9882e+12 42512
+ Gr_Liv_Area    1 2.0878e+08 1.9896e+12 42513
- TotRms_AbvGrd  1 8.4349e+09 1.9983e+12 42518
- Central_Air    1 1.6410e+10 2.0063e+12 42526
- Roof_Style     5 2.6087e+10 2.0159e+12 42528
- Half_Bath      1 2.5433e+10 2.0153e+12 42535
- Full_Bath      1 2.5541e+10 2.0154e+12 42535
- House_Style    7 4.2750e+10 2.0326e+12 42541
- Fireplaces     1 3.3235e+10 2.0231e+12 42543
- Lot_Area       1 3.5216e+10 2.0251e+12 42545
- Garage_Area    1 5.7881e+10 2.0477e+12 42568
- Bldg_Type      4 6.7805e+10 2.0577e+12 42572
- Second_Flr_SF  1 1.1446e+11 2.1043e+12 42624
- First_Flr_SF   1 3.5400e+11 2.3438e+12 42845
- Overall_Qual   9 1.4397e+12 3.4296e+12 43610</code></pre>
</div>
</div>
</section>
</section>
<section id="issues-with-automatic-search-algorithms" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Issues With Automatic Search Algorithms</h1>
<ul>
<li>Biases in parameter estimates, predictions, standard errors</li>
<li>Incorrect calculation of degrees of freedom (p-value method)</li>
<li>P-values that tend to err on the side of overestimating significance</li>
<li>Can result in locally best model (not global)</li>
</ul>
<p>In terms of p-value, you should always adjust your <span class="math inline">\(\alpha\)</span> size based on your sample size.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/conservative-p-values.png" class="img-fluid figure-img"></p>
<figcaption>Conservative P-Values</figcaption>
</figure>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/yangrchen\.github\.io\/msa_blog\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>