<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Yang Chen">
<meta name="dcterms.date" content="2023-06-12">

<title>Yang MSA - Analysis of Variance</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../../../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Yang MSA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../notes/index.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/yangrchen"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Analysis of Variance</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">primer</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Yang Chen </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">June 12, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#two-sample-hypothesis-testing" id="toc-two-sample-hypothesis-testing" class="nav-link active" data-scroll-target="#two-sample-hypothesis-testing"><span class="header-section-number">1</span> Two Sample Hypothesis Testing</a>
  <ul class="collapse">
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions"><span class="header-section-number">1.1</span> Assumptions</a></li>
  <li><a href="#pooled-standard-deviation" id="toc-pooled-standard-deviation" class="nav-link" data-scroll-target="#pooled-standard-deviation"><span class="header-section-number">1.2</span> Pooled Standard Deviation</a>
  <ul class="collapse">
  <li><a href="#assumption-on-pooled-std.-deviation" id="toc-assumption-on-pooled-std.-deviation" class="nav-link" data-scroll-target="#assumption-on-pooled-std.-deviation"><span class="header-section-number">1.2.1</span> Assumption on Pooled Std. Deviation</a></li>
  </ul></li>
  <li><a href="#confidence-interval" id="toc-confidence-interval" class="nav-link" data-scroll-target="#confidence-interval"><span class="header-section-number">1.3</span> Confidence Interval</a></li>
  <li><a href="#testing-difference-in-means---unequal-variances" id="toc-testing-difference-in-means---unequal-variances" class="nav-link" data-scroll-target="#testing-difference-in-means---unequal-variances"><span class="header-section-number">1.4</span> Testing Difference in Means - Unequal Variances</a></li>
  <li><a href="#confidence-interval-1" id="toc-confidence-interval-1" class="nav-link" data-scroll-target="#confidence-interval-1"><span class="header-section-number">1.5</span> Confidence Interval</a></li>
  <li><a href="#example---comparing-two-means" id="toc-example---comparing-two-means" class="nav-link" data-scroll-target="#example---comparing-two-means"><span class="header-section-number">1.6</span> Example - Comparing Two Means</a></li>
  </ul></li>
  <li><a href="#testing-differences-in-variances" id="toc-testing-differences-in-variances" class="nav-link" data-scroll-target="#testing-differences-in-variances"><span class="header-section-number">2</span> Testing Differences in Variances</a>
  <ul class="collapse">
  <li><a href="#example---comparing-two-variances" id="toc-example---comparing-two-variances" class="nav-link" data-scroll-target="#example---comparing-two-variances"><span class="header-section-number">2.1</span> Example - Comparing Two Variances</a></li>
  </ul></li>
  <li><a href="#matched-paired-differences" id="toc-matched-paired-differences" class="nav-link" data-scroll-target="#matched-paired-differences"><span class="header-section-number">3</span> Matched / Paired Differences</a>
  <ul class="collapse">
  <li><a href="#example---sources-of-variation" id="toc-example---sources-of-variation" class="nav-link" data-scroll-target="#example---sources-of-variation"><span class="header-section-number">3.1</span> Example - Sources of Variation</a></li>
  <li><a href="#confidence-interval-2" id="toc-confidence-interval-2" class="nav-link" data-scroll-target="#confidence-interval-2"><span class="header-section-number">3.2</span> Confidence Interval</a></li>
  <li><a href="#example---paired-samples" id="toc-example---paired-samples" class="nav-link" data-scroll-target="#example---paired-samples"><span class="header-section-number">3.3</span> Example - Paired Samples</a></li>
  </ul></li>
  <li><a href="#testing-population-proportions" id="toc-testing-population-proportions" class="nav-link" data-scroll-target="#testing-population-proportions"><span class="header-section-number">4</span> Testing Population Proportions</a>
  <ul class="collapse">
  <li><a href="#confidence-interval-3" id="toc-confidence-interval-3" class="nav-link" data-scroll-target="#confidence-interval-3"><span class="header-section-number">4.1</span> Confidence Interval</a></li>
  <li><a href="#comprehensive-example" id="toc-comprehensive-example" class="nav-link" data-scroll-target="#comprehensive-example"><span class="header-section-number">4.2</span> Comprehensive Example</a></li>
  <li><a href="#example-continued" id="toc-example-continued" class="nav-link" data-scroll-target="#example-continued"><span class="header-section-number">4.3</span> Example Continued</a></li>
  </ul></li>
  <li><a href="#analysis-of-variance" id="toc-analysis-of-variance" class="nav-link" data-scroll-target="#analysis-of-variance"><span class="header-section-number">5</span> Analysis of Variance</a>
  <ul class="collapse">
  <li><a href="#one-way-anova" id="toc-one-way-anova" class="nav-link" data-scroll-target="#one-way-anova"><span class="header-section-number">5.1</span> One-Way ANOVA</a>
  <ul class="collapse">
  <li><a href="#assumptions-1" id="toc-assumptions-1" class="nav-link" data-scroll-target="#assumptions-1"><span class="header-section-number">5.1.1</span> Assumptions</a></li>
  <li><a href="#sources-of-variation" id="toc-sources-of-variation" class="nav-link" data-scroll-target="#sources-of-variation"><span class="header-section-number">5.1.2</span> Sources of Variation</a></li>
  <li><a href="#sum-of-squares-within" id="toc-sum-of-squares-within" class="nav-link" data-scroll-target="#sum-of-squares-within"><span class="header-section-number">5.1.3</span> Sum of Squares Within</a></li>
  <li><a href="#sum-of-squares-between" id="toc-sum-of-squares-between" class="nav-link" data-scroll-target="#sum-of-squares-between"><span class="header-section-number">5.1.4</span> Sum of Squares Between</a></li>
  </ul></li>
  <li><a href="#partitioning-variability-in-anova" id="toc-partitioning-variability-in-anova" class="nav-link" data-scroll-target="#partitioning-variability-in-anova"><span class="header-section-number">5.2</span> Partitioning Variability in ANOVA</a></li>
  <li><a href="#anova-f-test" id="toc-anova-f-test" class="nav-link" data-scroll-target="#anova-f-test"><span class="header-section-number">5.3</span> ANOVA F-test</a></li>
  <li><a href="#one-way-anova-table" id="toc-one-way-anova-table" class="nav-link" data-scroll-target="#one-way-anova-table"><span class="header-section-number">5.4</span> One-Way ANOVA Table</a></li>
  <li><a href="#one-way-anova-example" id="toc-one-way-anova-example" class="nav-link" data-scroll-target="#one-way-anova-example"><span class="header-section-number">5.5</span> One-Way ANOVA Example</a></li>
  </ul></li>
  <li><a href="#multiple-comparisons" id="toc-multiple-comparisons" class="nav-link" data-scroll-target="#multiple-comparisons"><span class="header-section-number">6</span> Multiple Comparisons</a>
  <ul class="collapse">
  <li><a href="#multiple-comparisons-problem" id="toc-multiple-comparisons-problem" class="nav-link" data-scroll-target="#multiple-comparisons-problem"><span class="header-section-number">6.1</span> Multiple Comparisons Problem</a>
  <ul class="collapse">
  <li><a href="#different-types-of-error" id="toc-different-types-of-error" class="nav-link" data-scroll-target="#different-types-of-error"><span class="header-section-number">6.1.1</span> Different Types of Error</a></li>
  </ul></li>
  <li><a href="#multiple-comparison-methods" id="toc-multiple-comparison-methods" class="nav-link" data-scroll-target="#multiple-comparison-methods"><span class="header-section-number">6.2</span> Multiple Comparison Methods</a></li>
  <li><a href="#tukeys-hsd-test" id="toc-tukeys-hsd-test" class="nav-link" data-scroll-target="#tukeys-hsd-test"><span class="header-section-number">6.3</span> Tukey’s HSD Test</a></li>
  </ul></li>
  <li><a href="#fixed-vs.-random-effects" id="toc-fixed-vs.-random-effects" class="nav-link" data-scroll-target="#fixed-vs.-random-effects"><span class="header-section-number">7</span> Fixed vs.&nbsp;Random Effects</a>
  <ul class="collapse">
  <li><a href="#randomized-blocking" id="toc-randomized-blocking" class="nav-link" data-scroll-target="#randomized-blocking"><span class="header-section-number">7.1</span> Randomized Blocking</a>
  <ul class="collapse">
  <li><a href="#sources-of-variation-1" id="toc-sources-of-variation-1" class="nav-link" data-scroll-target="#sources-of-variation-1"><span class="header-section-number">7.1.1</span> Sources of Variation</a></li>
  </ul></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><span class="header-section-number">7.2</span> Example</a></li>
  <li><a href="#assumptions-2" id="toc-assumptions-2" class="nav-link" data-scroll-target="#assumptions-2"><span class="header-section-number">7.3</span> Assumptions</a></li>
  <li><a href="#sum-of-squares-blocks" id="toc-sum-of-squares-blocks" class="nav-link" data-scroll-target="#sum-of-squares-blocks"><span class="header-section-number">7.4</span> Sum of Squares Blocks</a></li>
  <li><a href="#blocking-anova-table" id="toc-blocking-anova-table" class="nav-link" data-scroll-target="#blocking-anova-table"><span class="header-section-number">7.5</span> Blocking ANOVA Table</a></li>
  <li><a href="#post-hoc-analysis-for-blocking" id="toc-post-hoc-analysis-for-blocking" class="nav-link" data-scroll-target="#post-hoc-analysis-for-blocking"><span class="header-section-number">7.6</span> Post-hoc Analysis for blocking</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="two-sample-hypothesis-testing" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Two Sample Hypothesis Testing</h1>
<p>One sample hypothesis tests are focused on one population parameter. However, sometimes we would like to compare multiple parameters against each other. This is the foundation of an analysis called <strong>analysis of variance (ANOVA)</strong>.</p>
<p>Recall the one-sample case:</p>
<p><span class="math display">\[
H_0: \mu
\begin{cases}
\geq \\
= \\
\leq
\end{cases}
\ \ \mu_0
\]</span></p>
<p><span class="math display">\[
H_a: \mu
\begin{cases}
&lt; \\
\neq \\
&gt;
\end{cases}
\mu_0
\]</span></p>
<p>In the two-sample case, there are two parameters we are calculating so now we have an expression:</p>
<p><span class="math display">\[
H_0: \mu_1 - \mu_2
\begin{cases}
\geq \\
= \\
\leq
\end{cases}
\ 0
\]</span></p>
<p><span class="math display">\[
H_a: \mu_1 - \mu_2
\begin{cases}
&lt; \\
\neq \\
&gt;
\end{cases}
\ 0
\]</span></p>
<section id="assumptions" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="assumptions"><span class="header-section-number">1.1</span> Assumptions</h2>
<ul>
<li>Assume two samples are independent of each other</li>
<li>We have to take into account whether the variances are equal or not
<ul>
<li>Different hypothesis test structures depends on whether or not variances are equal</li>
</ul></li>
</ul>
<p>Recall that our general test statistic is calculated as</p>
<p><span class="math display">\[
\begin{align*}
\text{Test Statistic} &amp;= \frac{\text{Statistic} - \text{Null Value}}{\text{Standard Error}} \\
\ \\
&amp;= \frac{(\bar{x}_1 - \bar{x}_2) - D_0}{s_p\sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}
\end{align*}
\]</span></p>
<ul>
<li><span class="math inline">\(s_p\)</span> is the pooled standard deviation</li>
</ul>
<p>We then calculate our p-value based on the t-distribution with <span class="math inline">\(d.f. = n_1 - 1 + n_2 - 1 = n_1 + n_2 - 2\)</span></p>
</section>
<section id="pooled-standard-deviation" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="pooled-standard-deviation"><span class="header-section-number">1.2</span> Pooled Standard Deviation</h2>
<p>Under assumption of <em>equal variances</em> we have two estimates of population variance–<span class="math inline">\(s_1^2\)</span> and <span class="math inline">\(s_2^2\)</span>. We should combine both to get our estimate:</p>
<p><span class="math display">\[
\begin{align*}
s_p &amp;= \sqrt{\frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2}} \\
\ \\
&amp;= \sqrt{\frac{\sum (x_{1,i} - \bar{x}_1)^2 + \sum (x_{2,i} - \bar{x}_2)^2}{n_1 + n_2 - 2}}
\end{align*}
\]</span></p>
<section id="assumption-on-pooled-std.-deviation" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="assumption-on-pooled-std.-deviation"><span class="header-section-number">1.2.1</span> Assumption on Pooled Std. Deviation</h3>
<ul>
<li>Each population has an approximate Normal distribution</li>
<li>Variances of two groups are equal</li>
</ul>
</section>
</section>
<section id="confidence-interval" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="confidence-interval"><span class="header-section-number">1.3</span> Confidence Interval</h2>
<p><span class="math display">\[
(\bar{x}_1 - \bar{x}_2) \pm t_{\alpha/2} \times s_p \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}
\]</span></p>
</section>
<section id="testing-difference-in-means---unequal-variances" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="testing-difference-in-means---unequal-variances"><span class="header-section-number">1.4</span> Testing Difference in Means - Unequal Variances</h2>
<p><strong>Hypothesis Statements:</strong></p>
<ul>
<li>Same as the prior tests</li>
</ul>
<p><strong>Our Test Statistic:</strong></p>
<p><span class="math display">\[
\text{Test Statistic} = \frac{(\bar{x}_1 - \bar{x}_2) - D_0}{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}
\]</span></p>
<ul>
<li>Standard error changes since we need to test estimates of our two separate population variances separately <span class="math inline">\(\rightarrow\)</span> cannot “pool” them</li>
</ul>
<p>The degrees of freedom on our t-test are a more complicated expression:</p>
<p><span class="math display">\[
d.f. = \frac{(\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2})^2}{\frac{(\frac{s_1^2}{n_1})^2}{n_1 - 1} + \frac{(\frac{s_2^2}{n_2})^2}{n_2 - 1}}
\]</span></p>
</section>
<section id="confidence-interval-1" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="confidence-interval-1"><span class="header-section-number">1.5</span> Confidence Interval</h2>
<p>For different variances, we don’t use the pooled variance</p>
<p><span class="math display">\[
(\bar{x}_1 - \bar{x}_2) \pm t_{\alpha/2}^* \times \sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}
\]</span></p>
<ul>
<li>Standard error changes using separate population variances</li>
</ul>
</section>
<section id="example---comparing-two-means" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="example---comparing-two-means"><span class="header-section-number">1.6</span> Example - Comparing Two Means</h2>
<blockquote class="blockquote">
<p>A human resources manager of a large business firm is trying to determine if there exists gender bias in the pay scale of employees at the company. The manager assumes the variability of salaries between genders is different, but wants to test if makes have higher average salary than females. The manager samples 62 males and 77 females. The sample of males had an average salary of $87,547 with a s.d. of $5,910. The sample of females had an average salary of $78,289 with a s.d. of $6,276. Run a hypothesis test.</p>
</blockquote>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># H_a: mu_1 &gt; mu_2 with mu_1 representing mean of males</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> ((<span class="dv">87547</span> <span class="sc">-</span> <span class="dv">78289</span>) <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5910</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">62</span> <span class="sc">+</span> <span class="dv">6276</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">77</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Test statistic equals %.3f"</span>, t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Test statistic equals 8.930"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> (<span class="dv">5910</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">62</span> <span class="sc">+</span> <span class="dv">6276</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">77</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> ((<span class="dv">5910</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">62</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">61</span> <span class="sc">+</span> (<span class="dv">6276</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">77</span>)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">76</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Df: %d"</span>, <span class="fu">floor</span>(df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Df: 133"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(t, df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.468658e-15</code></pre>
</div>
</div>
</section>
</section>
<section id="testing-differences-in-variances" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Testing Differences in Variances</h1>
<p>Previously we needed to assume the relationship between two variances to conduct test between means. We can run a <strong>hypothesis test comparing two variances</strong> to tell us which means test to use.</p>
<p>Keep in mind there is no formal statistical test for comparing standard deviations–only variances.</p>
<p><span class="math display">\[
H_0: \frac{\sigma_1^2}{\sigma_2^2}
\begin{cases}
\geq \\
= \\
\leq
\end{cases}
\ \ 1
\]</span></p>
<p><span class="math display">\[
H_a: \frac{\sigma_1^2}{\sigma_2^2}
\begin{cases}
&lt; \\
\neq \\
&gt;
\end{cases}
\ \ 1
\]</span></p>
<ul>
<li>Assume two samples are ind. of each other–value selected in one sample has no bearing on value selected on other sample</li>
<li>Original populatino distributions are assumed to be approx. Normal</li>
</ul>
<p><strong>Hypothesis Statements:</strong></p>
<p><span class="math display">\[
H_0: \frac{\sigma_1^2}{\sigma_2^2} \hspace{1cm} H_a: \frac{\sigma_1^2}{\sigma_2^2} \neq 1
\]</span></p>
<p><strong>Test Statistic:</strong></p>
<p><span class="math display">\[
F = \frac{s_i^2}{s_j^2}
\]</span></p>
<p><span class="math display">\[
d.f._i = n_i - 1 \hspace{1cm} d.f._j = n_j - 1
\]</span></p>
<ul>
<li>The numerator is the larger standard deviation between two samples</li>
</ul>
<section id="example---comparing-two-variances" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="example---comparing-two-variances"><span class="header-section-number">2.1</span> Example - Comparing Two Variances</h2>
<blockquote class="blockquote">
<p>A human resources manager of a large business firm is trying to determine if there exists gender bias in the pay scale of employees at the company. The manager has no assumption about the variability of salaries between genders, but wants to test if makes have higher average salary than females. The manager samples 62 males and 77 females. The sample of males had an average salary of $87,547 with a s.d. of $5,910. The sample of females had an average salary of $78,289 with a s.d. of $6,276. Run a hypothesis test.</p>
<p><strong>Need to first test if variances are equal or not before running test of means</strong></p>
</blockquote>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="dv">6276</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">5910</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"F Statistic: %.3f"</span>, f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F Statistic: 1.128"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="dv">76</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="dv">61</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(f, df1, df2, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3147624</code></pre>
</div>
</div>
<p>At a significance level of 0.05 we would not reject the null hypothesis that our variances are different.</p>
</section>
</section>
<section id="matched-paired-differences" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Matched / Paired Differences</h1>
<p>Some instances where a paired difference (matched) sample is used to control for sources of variation that might distort conclusions</p>
<section id="example---sources-of-variation" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="example---sources-of-variation"><span class="header-section-number">3.1</span> Example - Sources of Variation</h2>
<ul>
<li>You have SAT scores for both boys and girls from a local school</li>
<li>You believe that the boys and girls have the same avg. test score, but want to test otherwise</li>
<li>Of the 39 females, 32 of them are part of the accelerated math and language arts program</li>
<li>Of the 39 males, 11 of them are part of the accelerated math and language arts program</li>
</ul>
<p><strong>Matched samples</strong> are samples selected such that each data value from one sample is related (or matched / paired) with a corresponding data value from a second sample</p>
<p>In the previous example, we would match boys and girls who were in the accelerated program and ones who were not.</p>
<p>Our focus turns from individual values in the populations and to the values of the differences in the populations. All assumptions and calculations are done on the differences, not individual samples.</p>
<p><span class="math display">\[
H_0: \mu_d
\begin{cases}
\geq \\
= \\
\leq
\end{cases}
\ \ D_0
\]</span></p>
<p><span class="math display">\[
H_a: \mu_d
\begin{cases}
&lt; \\
\neq \\
&gt;
\end{cases}
\ \ D_0
\]</span></p>
<ul>
<li>Assumptions for matched pairs hypothesis test are same as for regular hypothesis test for means</li>
<li>Large sample (<span class="math inline">\(n &gt; 50\)</span>) of differences</li>
<li>Small samples with differences having Normal distribution</li>
</ul>
<p><strong>Hypothesis Statements:</strong></p>
<p><span class="math display">\[
H_0: \mu_d
\begin{cases}
\geq \\
= \\
\leq
\end{cases}
\ \ D_0
\hspace{2cm}
H_a: \mu_d
\begin{cases}
test
\end{cases}
\]</span></p>
<p><strong>Test Statistic:</strong></p>
<p><span class="math display">\[
t = \frac{\bar{x}_d - D_0}{\frac{s_d}{\sqrt{n_d}}}
\]</span></p>
<p><span class="math display">\[ d.f. = n_d - 1 \]</span></p>
</section>
<section id="confidence-interval-2" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="confidence-interval-2"><span class="header-section-number">3.2</span> Confidence Interval</h2>
<p><span class="math display">\[
\bar{x}_d \pm t_{\alpha/2}^* \times \frac{s_d}{\sqrt{n_d}}
\]</span></p>
</section>
<section id="example---paired-samples" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="example---paired-samples"><span class="header-section-number">3.3</span> Example - Paired Samples</h2>
<blockquote class="blockquote">
<p>A human resources manager of a large business firm is trying to determine if there exists gender bias in the pay scale of employees at the company. The manager samples 51 pairs of male and female employees where the pair has the same job title and experience at the company. The average difference in salaries is $2,131 with a s.d. of differences of $7,898. Run a hypothesis test.</p>
</blockquote>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> (<span class="dv">2131</span> <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">/</span> (<span class="dv">7898</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">51</span>))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Test statistic: %.3f"</span>, t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Test statistic: 1.927"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(t, df, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02984447</code></pre>
</div>
</div>
<p>At a significant level of 0.05 we reject the null hypothesis that there is no gender bias in the pay scale of employees at the company.</p>
</section>
</section>
<section id="testing-population-proportions" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Testing Population Proportions</h1>
<p><span class="math display">\[
H_0: p_1 - p_2
\begin{cases}
\geq \\
= \\
\leq
\end{cases}
\ \ 0
\]</span></p>
<p><span class="math display">\[
H_a: p_1 - p_2
\begin{cases}
&lt; \\
\neq \\
&gt;
\end{cases}
\ \ 0
\]</span></p>
<ul>
<li>Assume two samples are ind. of each other</li>
<li>Sample size has to be large just like with single proportion</li>
<li><span class="math inline">\(n_1p_1 \geq 5 \hspace{1cm} n_2p_2 \geq 5\)</span></li>
<li><span class="math inline">\((1 - n_1)p_1 \geq 5 \hspace{1cm} (1 - n_2)p_2 \geq 5\)</span></li>
</ul>
<p><strong>Hypothesis Statements:</strong></p>
<p><span class="math display">\[
H_0: p_1 - p_2
\begin{cases}
\geq \\
= \\
\leq
\end{cases}
\ \ D_0
\hspace{2cm}
H_a: p_1 - p_2
\begin{cases}
&lt; \\
\neq \\
&gt;
\end{cases}
\ \ D_0
\]</span></p>
<p><strong>Test Statistic:</strong></p>
<p><span class="math display">\[
\text{Test Statistic} = \frac{(p_1 - p_2) - D_0}{\sqrt{\bar{p}(1 - \bar{p})(\frac{1}{n_1} + \frac{1}{n_2})}}
\]</span></p>
<p><span class="math display">\[
\bar{p} = \frac{n_1p_1 + n_2p_2}{n_1 + n_2}
\]</span></p>
<ul>
<li>Estimates of the proportion are combined together</li>
</ul>
<p>When we calculate our p-value we use the Normal distribution.</p>
<section id="confidence-interval-3" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="confidence-interval-3"><span class="header-section-number">4.1</span> Confidence Interval</h2>
<p><span class="math display">\[
(p_1 - p_2) \pm z^* \times \sqrt{\frac{p_1(1 - p_1)}{n_1} + \frac{p_2(1 - p_2)}{n_2}}
\]</span></p>
</section>
<section id="comprehensive-example" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="comprehensive-example"><span class="header-section-number">4.2</span> Comprehensive Example</h2>
<blockquote class="blockquote">
<p>A researcher at a large university on the west coast is interested in comparing some factors between upperclassmen (juniors and seniors) and underclassmen (freshmen and sophomores) in the undergraduate school. The researcher believes that more experience in college may help students perform better in the classroom. The researcher is interested in testing if the average GPA of upperclassmen is greater than the average GPA of underclassmen. The researcher sampled 89 underclassmen with an average GPA of 2.75 with a s.d. of 0.91 and 102 upperclassmen with an average GPA of 3.07 and a s.d. of 1.02.</p>
</blockquote>
<blockquote class="blockquote">
<ol type="1">
<li>The researcher did not use matched sampling. Do you agree with their decision?</li>
</ol>
</blockquote>
<p>No.&nbsp;There are other factors that can influence GPA like major that we could match on for equal comparison</p>
<blockquote class="blockquote">
<ol start="2" type="1">
<li>Conduct a hypothesis test on the variances to see if they are equal.</li>
</ol>
</blockquote>
<p><span class="math display">\[
H_0: \frac{\sigma_1^2}{\sigma_2^2} \leq 1
\hspace{2cm}
H_a: \frac{\sigma_1^2}{\sigma_2^2} &gt; 1
\]</span></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fl">1.02</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fl">0.91</span><span class="sc">^</span><span class="dv">2</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"F Statistic: %0.3f"</span>, f)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "F Statistic: 1.256"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="dv">101</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="dv">88</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(f, df1, df2, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1367661</code></pre>
</div>
</div>
<p>Based on a significance level of 0.05 we do not reject the null hypothesis. We do not have enough evidence to say that the variances between the two populations is different.</p>
<blockquote class="blockquote">
<ol start="3" type="1">
<li>Conduct the appropriate hypothesis test on the means to see if they are equal.</li>
</ol>
</blockquote>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>s_p <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(((<span class="dv">101</span> <span class="sc">*</span> <span class="fl">1.02</span><span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> (<span class="dv">88</span> <span class="sc">*</span> <span class="fl">0.91</span><span class="sc">^</span><span class="dv">2</span>)) <span class="sc">/</span> (<span class="dv">102</span> <span class="sc">+</span> <span class="dv">89</span> <span class="sc">-</span> <span class="dv">2</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Pooled std. dev: %0.3f"</span>, s_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Pooled std. dev: 0.970"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> ((<span class="fl">3.07</span> <span class="sc">-</span> <span class="fl">2.75</span>) <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">/</span> (s_p <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">102</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">89</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Test Statistic: %0.3f"</span>, t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Test Statistic: 2.274"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(t, <span class="dv">89</span> <span class="sc">+</span> <span class="dv">102</span> <span class="sc">-</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01205843</code></pre>
</div>
</div>
<p>At a significance level of 0.05 we reject our null hypothesis that more experience in college does not lead to higher GPA performance.</p>
</section>
<section id="example-continued" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="example-continued"><span class="header-section-number">4.3</span> Example Continued</h2>
<blockquote class="blockquote">
<p>Same researcher as before also believes that a higher proportion of upperclassmen live off campus compared to the proportion of underclassmen. While sampling the students in the previous sample, the researcher also asked whether the student lived off campus. Of the 89 underclassmen sampled, 27 lived off campus. Of the 102 upperclassmen sampled, 65 lived off campus.</p>
</blockquote>
<blockquote class="blockquote">
<p>Construct a 95% confidence interval for the difference between the proportion of upperclassmen living off campus to the proportion of underclassmen living off campus.</p>
</blockquote>
<p><span class="math display">\[
H_0: p_1 - p_2 \leq 0 \hspace{1cm} H_a: p_1 - p_2 &gt; 0
\]</span></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="dv">65</span> <span class="sc">/</span> <span class="dv">102</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="dv">27</span> <span class="sc">/</span> <span class="dv">89</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Upper p: %0.3f, Under p: %0.3f"</span>, p1, p2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Upper p: 0.637, Under p: 0.303"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>p_mean <span class="ot">&lt;-</span> (<span class="dv">102</span> <span class="sc">*</span> p1 <span class="sc">+</span> <span class="dv">89</span> <span class="sc">*</span> p2) <span class="sc">/</span> (<span class="dv">102</span> <span class="sc">+</span> <span class="dv">89</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"p_mean: %0.3f"</span>, p_mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "p_mean: 0.482"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> ((p1 <span class="sc">-</span> p2) <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">/</span> <span class="fu">sqrt</span>(p_mean <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_mean) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> <span class="dv">102</span> <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">89</span>))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Z Statistic: %0.3f"</span>, z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Z Statistic: 4.607"</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>z_crit <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.05</span> <span class="sc">/</span> <span class="dv">2</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>z_crit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.959964</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>margin <span class="ot">&lt;-</span> z_crit <span class="sc">*</span> <span class="fu">sqrt</span>(p1 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p1) <span class="sc">/</span> <span class="dv">102</span> <span class="sc">+</span> p2 <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p2) <span class="sc">/</span> <span class="dv">89</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>margin</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1335203</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"95 perc. CI: %0.3f plus-minus %0.3f"</span>, p1 <span class="sc">-</span> p2, margin)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "95 perc. CI: 0.334 plus-minus 0.134"</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Conduct the appropriate hypothesis test to test the researcher’s claim.</p>
</blockquote>
<p><span class="math display">\[
H_0: p_1 - p_2 \leq 0 \hspace{1cm} H_a: p_1 - p_2 &gt; 0
\]</span></p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(z, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.044913e-06</code></pre>
</div>
</div>
<p>At a significance level of 0.0005 we reject the null hypothesis that the proportion of upperclassmen living off campus is not greater than the proportion of underclassmen living off campus.</p>
<blockquote class="blockquote">
<p>Can you compare the confidence interval and the hypothesis test?</p>
</blockquote>
<p>No as the hypothesis test is one-sided while the confidence interval is two-sided.</p>
</section>
</section>
<section id="analysis-of-variance" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Analysis of Variance</h1>
<p>The comparison of more than two categories of parameters is called <strong>analysis of variance</strong>.</p>
<section id="one-way-anova" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="one-way-anova"><span class="header-section-number">5.1</span> One-Way ANOVA</h2>
<p>Simplest form of ANOVA is the one-way model.</p>
<ul>
<li>Independent samples are obtained from <span class="math inline">\(k\)</span> levels (categories) of a single factor (explanatory variable), then testing whether the <span class="math inline">\(k\)</span> levels have equal means.</li>
<li>Similar to regression analysis in that we have one categorical variable predicting continuous response</li>
</ul>
<p><span class="math display">\[
H_0: \mu_1 = \mu_2 = \cdots = \mu_k
\]</span></p>
<p><span class="math display">\[
H_a: \text{At least one mean different than another}
\]</span></p>
<section id="assumptions-1" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="assumptions-1"><span class="header-section-number">5.1.1</span> Assumptions</h3>
<ul>
<li>Normally distributed categories</li>
<li>Equality of variances between categories</li>
<li>Independence</li>
</ul>
<p><strong>Test Statistic:</strong></p>
<p><span class="math display">\[
F = \frac{s_{max}^2}{s_{min}^2}
\]</span></p>
<p>The p-value is calculated from Hartley-s F-max distribution which isn’t covered here.</p>
</section>
<section id="sources-of-variation" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="sources-of-variation"><span class="header-section-number">5.1.2</span> Sources of Variation</h3>
<ul>
<li><strong>Within-Sample Variability</strong>
<ul>
<li>Variability in response that exists within category of a variable
<ul>
<li>What you categories cannot explain (like SSE)</li>
</ul></li>
</ul></li>
<li><strong>Between-Sample Variability</strong>
<ul>
<li>Variability in response that exists between categories of a variable
<ul>
<li>What you categories can explain (like SSR)</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="sum-of-squares-within" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="sum-of-squares-within"><span class="header-section-number">5.1.3</span> Sum of Squares Within</h3>
<p>Within sample is variability that you cannot explain by just knowing which category your observation falls into</p>
<p><span class="math display">\[
SSW = \sum_{i=1}^k\sum_{j=1}^{n_i} (x_{i,j} - \bar{x}_i)^2
\]</span></p>
</section>
<section id="sum-of-squares-between" class="level3" data-number="5.1.4">
<h3 data-number="5.1.4" class="anchored" data-anchor-id="sum-of-squares-between"><span class="header-section-number">5.1.4</span> Sum of Squares Between</h3>
<p>Between sample is variability that you can explain by just knowing which category your observation falls into</p>
<p><span class="math display">\[
SSB = \sum_{i=1}^k n_i(\bar{x}_i - \bar{\bar{x}})^2
\]</span></p>
</section>
</section>
<section id="partitioning-variability-in-anova" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="partitioning-variability-in-anova"><span class="header-section-number">5.2</span> Partitioning Variability in ANOVA</h2>
<div class="cell" data-fig-width="10" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
A(Total Variability) --&gt; B(SSR + SSE)
B --&gt; C[Variability Between Groups]
B --&gt; D[Variability Within Groups]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="anova-f-test" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="anova-f-test"><span class="header-section-number">5.3</span> ANOVA F-test</h2>
<p><span class="math display">\[
\begin{align*}
H_0&amp;: \mu_1 = \mu_2 = \cdots = \mu_k \\
H_a&amp;: \text{At least one mean different than another}
\end{align*}
\]</span></p>
<p>Test follows an F-distribution and is calculated as</p>
<p><span class="math display">\[
F = \frac{(\frac{SSB}{k - 1})}{(\frac{SSW}{N - k})}
\]</span></p>
<ul>
<li><span class="math inline">\(k\)</span> categories would be <span class="math inline">\(k - 1\)</span> variables in a regression model</li>
<li><span class="math inline">\(N\)</span> is the total sample size across all categories</li>
</ul>
</section>
<section id="one-way-anova-table" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="one-way-anova-table"><span class="header-section-number">5.4</span> One-Way ANOVA Table</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/one_way_anova_table.png" class="img-fluid figure-img"></p>
<figcaption>One-Way ANOVA Table</figcaption>
</figure>
</div>
</section>
<section id="one-way-anova-example" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="one-way-anova-example"><span class="header-section-number">5.5</span> One-Way ANOVA Example</h2>
<blockquote class="blockquote">
<p>A marketing analyst is interested in testing the effectiveness of 4 different commercials describing their company’s new product. The marketing analyst randomly assigns a commercial to each of 32 cities across the country and measures the average increase in sales of their new product at their stores. The marketing analyst wants to test if there is a difference in sales between the commercials.</p>
</blockquote>
<blockquote class="blockquote">
<ol type="1">
<li>Fill in the blanks on the ANOVA table.</li>
</ol>
</blockquote>
<table class="table">
<thead>
<tr class="header">
<th>Source</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">SS</th>
<th style="text-align: right;">MS</th>
<th style="text-align: right;">F-Value</th>
<th style="text-align: right;">P-Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Between</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2.3236</td>
<td style="text-align: right;">0.775</td>
<td style="text-align: right;">22.794</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td>Within</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">0.9587</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td>Total</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">3.2823</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(<span class="fl">22.794</span>, <span class="dv">3</span>, <span class="dv">28</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.128339e-07</code></pre>
</div>
</div>
</section>
</section>
<section id="multiple-comparisons" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Multiple Comparisons</h1>
<p>If you reject the null hypothesis on the F-test then you have evidence that at least one category is different.</p>
<p>Once a difference is detected, we have to test each individual pair of categories to find where the differences are.</p>
<p>This process is called <strong>multiple comparisons</strong> or <strong>ad-hoc testing</strong>.</p>
<section id="multiple-comparisons-problem" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="multiple-comparisons-problem"><span class="header-section-number">6.1</span> Multiple Comparisons Problem</h2>
<blockquote class="blockquote">
<p>You have a test which makes an error 5% of the time when performed.</p>
</blockquote>
<ul>
<li>What is the probability of making an error on your first test?
<ul>
<li>5%</li>
</ul></li>
<li>What is the probability of making an error on your second test?
<ul>
<li>5%</li>
</ul></li>
<li>What is the probability of making <em>at least</em> one error in two tests?
<ul>
<li>9.75%</li>
</ul></li>
</ul>
<section id="different-types-of-error" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="different-types-of-error"><span class="header-section-number">6.1.1</span> Different Types of Error</h3>
<p><strong>Comparison-wise error rate</strong></p>
<ul>
<li>Error rate for each individual test or comparison</li>
</ul>
<p><strong>Experiment-wise error rate</strong></p>
<ul>
<li>Error rate across all comparisons–proportion of experiments/comparisons in which at least one error occurs</li>
</ul>
<p>Tests and confidence intervals usually control for comparison-wise, <span class="math inline">\(\alpha\)</span>, but ideally want to control for experiment-wise.</p>
</section>
</section>
<section id="multiple-comparison-methods" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="multiple-comparison-methods"><span class="header-section-number">6.2</span> Multiple Comparison Methods</h2>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: right;">Number of Groups Compared</th>
<th style="text-align: right;">Number of Comparisons</th>
<th style="text-align: right;">Experimentwise Error Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.05</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.14</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.26</td>
</tr>
<tr class="even">
<td style="text-align: right;">5</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0.40</td>
</tr>
</tbody>
</table>
<ul>
<li><span class="math inline">\(EER \leq 1 - (1 - \alpha)^{nc}\)</span> where <span class="math inline">\(nc\)</span> is the number of comparisons</li>
</ul>
<div class="cell" data-fig-width="10" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
A(Control Comparisonwise Error Rate) --&gt; B(Pairwise t-tests)
C(Control Experimentwise Error Rate) --&gt; D[Compare All Pairs Tukey]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="tukeys-hsd-test" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="tukeys-hsd-test"><span class="header-section-number">6.3</span> Tukey’s HSD Test</h2>
<p>HSD represents the <strong>Honest Significant Difference</strong> or <strong>Critical Range</strong></p>
<p>We use Tukey’s when we consider pairwise comparisons</p>
<ul>
<li>Experimentwise error rate is equal to <span class="math inline">\(\alpha\)</span> when all pairwise comparisons are considered</li>
<li>Experimentwise error rate is less than <span class="math inline">\(\alpha\)</span> when fewer than all pairwise comparisons are considered</li>
<li>Replaces margin of error calculation for a typical confidence interval for a difference in means with an adjusted margin of error</li>
</ul>
<p><span class="math display">\[
\text{Critical Range (Margin of Error)} = q_a \times \sqrt{\frac{MSW}{2} \times (\frac{1}{n_i} + \frac{1}{n_j})}
\]</span></p>
<ul>
<li><span class="math inline">\(q_a\)</span> is from studentized range distribution</li>
</ul>
</section>
</section>
<section id="fixed-vs.-random-effects" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Fixed vs.&nbsp;Random Effects</h1>
<p>Inference drawn from ANOVA depends on whether the factor levels in the procedure are selected on purpose or randomly.</p>
<p><strong>Fixed Effects</strong></p>
<ul>
<li>Inferences extend only to factor levels being analyzed because the levels were purposefully chosen as levels of interest</li>
</ul>
<p><strong>Random Effects</strong></p>
<ul>
<li>Inferences extend beyond just factor levels being tested because the levels were randomly selected from a larger group of levels</li>
</ul>
<section id="randomized-blocking" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="randomized-blocking"><span class="header-section-number">7.1</span> Randomized Blocking</h2>
<section id="sources-of-variation-1" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="sources-of-variation-1"><span class="header-section-number">7.1.1</span> Sources of Variation</h3>
<p>Generally, comparing many population means works well in certain situations</p>
<p>There are some instances where <strong>blocking</strong> is used to control for sources of variation that might distort conclusions</p>
</section>
</section>
<section id="example" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="example"><span class="header-section-number">7.2</span> Example</h2>
<blockquote class="blockquote">
<p>The same marketing analyst as before is interested in testing the effectiveness of 4 different commercials describing their company’s new product. The marketing analyst randomly assigns a commercial to each of 32 cities across the country and measures the average increase in sales of their new product at their stores. The four commercial average sales were $1.2M for commercial A, $1.8M for B, <strong>$0.76M for C</strong>, and $1.3M for D. Where are the differences in sales?</p>
</blockquote>
<ul>
<li>What if the new product is a warm coat and a majority of the cities seeing C were warm weather cities?</li>
<li>The same marketing analyst as before is interested in testing the effectiveness of 4 different commercials describing their company’s new product. Split (<strong>block</strong>) country into 8 regions. Show each commercial to one city in each region. Sample size still 32.</li>
</ul>
</section>
<section id="assumptions-2" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="assumptions-2"><span class="header-section-number">7.3</span> Assumptions</h2>
<p>Same as One-Way ANOVA:</p>
<ul>
<li>Normally distributed categories</li>
<li>Equality of variances between categories</li>
<li>Independence</li>
</ul>
<p>Blocking can come from collection of data as well as the analysis of the data as a variable being added to the model.</p>
<p>When a new variable is added, we get a new source of variation–<strong>sum of squares of blocking</strong>.</p>
</section>
<section id="sum-of-squares-blocks" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="sum-of-squares-blocks"><span class="header-section-number">7.4</span> Sum of Squares Blocks</h2>
<p><span class="math display">\[
SSBL = \sum_{j=1}^b k(\bar{x}_j - \bar{\bar{x}})^2
\]</span></p>
<p>The sum of squares comes out of the error sum of squares and gets brought into the model–the SSW shrinks even more.</p>
</section>
<section id="blocking-anova-table" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="blocking-anova-table"><span class="header-section-number">7.5</span> Blocking ANOVA Table</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/one_way_anova_table_blocking.png" class="img-fluid figure-img"></p>
<figcaption>Blocking ANOVA Table</figcaption>
</figure>
</div>
<ul>
<li>The F-Value in the Blocking row is the F-test with <span class="math inline">\(H_a\)</span> at least one block mean not equal</li>
</ul>
</section>
<section id="post-hoc-analysis-for-blocking" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="post-hoc-analysis-for-blocking"><span class="header-section-number">7.6</span> Post-hoc Analysis for blocking</h2>
<p>Tukey-Kramer ANOVA comparisons do not work for blocking.</p>
<p>Instead, we have <strong>Fisher’s Least Significant Difference</strong>. Fisher’s LSD is a recalculation of the margin of error for the difference in means confidence interval just like Tukey’s critical range.</p>
<p><span class="math display">\[
LSD = t^* \times \sqrt{MSW} \times \sqrt{\frac{2}{b}}
\]</span></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>