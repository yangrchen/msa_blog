{
  "hash": "89933cef106c8715f0087d7311b3cd43",
  "result": {
    "markdown": "---\ntitle: Hypothesis Testing\ndate: 06/07/2023\ncategories:\n    -   hypothesis testing\n    -   statistics\n---\n\n# Hypothesis Testing Example\n\nAccording to the CLT, the the mean has a sampling distribution that follows a Normal distribution as long as the sample size is large enough.\n\nLet's take the average age of our customers as an example. Initially, we believe that the average age of our customers is $\\mu = 25$ years old with standard deviation $\\sigma = 10$.\n\nWe sample 100 customers and collect their age.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code code-fold=\"true\"}\nfrom scipy.stats import t\nimport numpy as np\nfrom scipy.stats import norm\nimport matplotlib.pyplot as plt\n\nmean = 25\nsd = 1\nalpha = 0.05\n\nx = np.linspace(20, 35, 1000)\n\ncrit_value = norm.ppf(1 - alpha / 2, loc=mean, scale=sd)\npdf = norm.pdf(x, loc=mean, scale=sd)\nplt.axvline(31, color='r')\n\nplt.plot(x, pdf)\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-2-output-1.png){width=579 height=411}\n:::\n:::\n\n\nWhat is the probability we see a sample mean $\\bar{x} = 31$ under our original assumption that the mean is 25?\n\nIt's very low! $< 0.0001$ so we have to strongly question our original hypothesis. We may no longer think it is true given the data.\n\n# Hypothesis Testing General Framework\n\n1.  Develop your hypothesis statements ($H_0, H_a$)\n2.  Collect data for your test statistic\n3.  What is the probability this happens? (P-Value)\n4.  Decision about null hypothesis\n5.  Summarize\n\n# Null and Alternative Hypothesis\n\nHypothesis testing is used to determine whether a statement about the value of a population parameter should or should not be rejected.\n\n-   The **null hypothesis**, $H_0$, is a tentative assumption about a population parameter. In the previous example this was $\\mu = 25$\n-   The **alternative hypothesis**, $H_a$, is the opposite of what is stated in the null hypothesis\n-   The context of situation is important in determining how the hypotheses should be stated\n-   Typically, alternative is what we are trying to test and want evidence for. Think of the null as the status quo or initial claim about our data\n\nGeneral Forms:\n\n$$\nH_0: \\mu \\leq \\mu_0 \\hspace{1cm} H_a: \\mu > \\mu_0\n$$\n\n$$\nH_0: \\mu \\geq \\mu_0 \\hspace{1cm} H_a: \\mu < \\mu_0\n$$\n\n$$\nH_0: \\mu = \\mu_0 \\hspace{1cm} H_a: \\mu \\neq \\mu_0\n$$\n\nThe first two general forms are **one-sided tests** while the last is a **two-sided test**.\n\n![Reject Regions](images/rejection_regions.png)\n\nWhen we have probabilities in the rejection region, we are no longer confident that our null hypothesis suffices. We are led to reject the null hypothesis at a certain confidence level that we have chosen.\n\n# Test Statistic\n\n$$\n\\text{Test Statistic} = \\frac{\\text{Statistic} - \\text{Null Value}}{\\text{Std. Error}}\n$$\n\nFor sample means, we need the t-distribution due the unknown values of the population standard deviation:\n\n$$\nt = \\frac{\\bar{x} - \\mu_0}{(\\frac{s}{\\sqrt{n}})}\n$$\n\nFor sample proportions, we use the normal distribution:\n\n$$\nz = \\frac{\\hat{p} - p_0}{\\sqrt{\\frac{p_0(1 - p_0)}{n}}}\n$$\n\n# P-Values\n\nAfter calculating the test statistic, we calculate the probability that we got the information we did from our sample, **assuming that our null hypothesis is true**.\n\n**P-value** is the probability we got our sample, or a sample more extreme, under the null hypothesis.\n\nIf p-value is low, it implies our sample from the population is extremely rare if we assume that null hypothesis is true. We are led to question the validity of the null hypothesis.\n\n# Significance Level\n\nWhen we do a hypothesis test we select a significance level, $\\alpha$, such that if the p-value is less than or equal to $\\alpha$ the value of the test statistic is in our rejection region.\n\n::: {.cell execution_count=2}\n``` {.python .cell-code code-fold=\"true\"}\nmean = 0\nsd = 1\nalpha = 0.05\n\nx_start = mean - 4 * sd\nx_end = mean + 4 * sd\nstep = 0.01\n\nx = np.arange(x_start, x_end, step)\ny = norm.pdf(x, mean, sd)\ncrit_value = norm.ppf(1 - alpha / 2, loc=mean, scale=sd)\ny_crit = norm.pdf(crit_value, mean, sd)\n\nplt.fill_between(x, y, where=y < y_crit, alpha=0.3)\nplt.fill_between(x, y, where=x < -2.25)\nplt.axvline(-2.25)\nplt.text(-2.2, 0, 't-value')\nplt.plot(x, y)\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-3-output-1.png){width=579 height=411}\n:::\n:::\n\n\n-   Reject $H_0$ if p-value $\\leq \\alpha$\n\n# Errors in Hypothesis Test\n\nHypothesis tests depend on sample data therefore they may not necessarily be accurate.\n\n## Type I Error\n\n-   Reject the null hypothesis when the null hypothesis was actually true (False rejection)\n-   Probability of making a Type I error in a hypothesis test is called the **significance level**\n\n## Type II Error\n\n-   Accepting the null hypothesis when the null hypothesis was actually false (False acceptance)\n-   Probability of *not* making a Type II error in a hypothesis test is called the **power**\n-   Difficult to control Type II error\n-   Can only control for Type I or Type II at a time\n\n# Test for Means (One Tailed Example)\n\n> You work for a business school as an analyst.\n>\n> The dean of the business school just went on record saying that students who just graduated **average** at least $3000 per month in salary.\n>\n> With a significance level of 0.05, conduct a hypothesis test on this claim.\n\n$$\nH_0: \\mu \\geq 3000\n$$\n\n$$\nH_a: \\mu < 3000\n$$\n\nSample data: $\\bar{x} = 2940, s = 165.7$\n\n$$\nt = \\frac{\\bar{x} - \\mu}{(\\frac{s}{\\sqrt{n}})} = \\frac{2940 - 3000}{(\\frac{165.7}{\\sqrt{12}})} = -1.25\n$$\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\nt_value = -1.25\n\nt.cdf(t_value, 11)\n```\n\n::: {.cell-output .cell-output-display execution_count=3}\n```\n0.11861959965915975\n```\n:::\n:::\n\n\nSince the p-value $> \\alpha$ we do not reject the null hypothesis.\n\n# Hypothesis Tests vs. Confidence Intervals\n\nUnder certain conditions, hypothesis tests and confidence intervals are conducting the same test.\n\n::: {.cell execution_count=4}\n``` {.python .cell-code code-fold=\"true\"}\nmean = 0\nsd = 1\nalpha = 0.05\n\nmean_sample = 4\nsd_sample = 1\n\nx_start = mean - 6 * sd\nx_end = mean + 6 * sd\nx_sample_start = mean_sample - 6 * sd_sample\nx_sample_end = mean_sample + 6 * sd_sample\nstep = 0.01\n\nx = np.arange(x_start, x_end, step)\ny = norm.pdf(x, mean, sd)\ncrit_value = norm.ppf(1 - alpha / 2, loc=mean, scale=sd)\ny_crit = norm.pdf(crit_value, mean, sd)\n\nx_sample = np.arange(x_sample_start, x_sample_end, step)\ny_sample = norm.pdf(x_sample, mean_sample, sd_sample)\nsample_crit_value = norm.ppf(1 - alpha / 2, loc=mean_sample, scale=sd_sample)\ny_crit_sample = norm.pdf(sample_crit_value, mean_sample, sd_sample)\n\nplt.fill_between(x, y, where=y < y_crit, alpha=0.3)\nplt.fill_between(x_sample, y_sample, where=y_sample > y_crit_sample, alpha=0.3)\nplt.axvline(mean)\nplt.axvline(mean_sample, color='r', linestyle='--')\n\nplt.plot(x, y)\nplt.plot(x_sample, y_sample)\n```\n\n::: {.cell-output .cell-output-display}\n![Reject $H_0$](index_files/figure-html/cell-5-output-1.png){width=579 height=411}\n:::\n:::\n\n\n-   If confidence interval around $\\bar{x}$ doesn't contain the null hypothesis $\\mu_0$ then we do reject $H_0$ as $\\bar{x}$ is in rejection region\n\n## Conditions\n\n1.  The hypothesis test is two-sided\n2.  $C = 1 - \\alpha$ where $C$ is the confidence level and $\\alpha$ is the significance level\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}