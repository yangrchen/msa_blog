{
  "hash": "24950ec9d18ede317541dfbbb5039491",
  "result": {
    "markdown": "---\ntitle: \"Confidence Intervals\"\ndate: 05/30/2023\ncategories:\n    - statistics\n---\n\nPoint estimators cannot be expected to provide exact values of population parameters. **Intervals** provide information about how close the point estimate is to the value of the parameter.\n\n**Confidence intervals** are interval estimates where we have a certain level of confidence in the interval.\n\nWhat does it mean when we are 95% confidence that the population mean is between 20 and 30?\n\n-   If we were to take many samples with the same sample size that each produced different confidence intervals, then 95% of them contain the true parameter\n-   This **DOES NOT** mean we have a 95% chance the population parameter falls inside our single confidence interval\n    -   The population parameter is not guaranteed to be contained within the interval\n\n# Margin of Error\n\nConfidence intervals are computed by adding a margin of error to our point estimate:\n\n$$\n\\text{Point Est.} \\pm \\text{Margin of Err.}\n$$\n\n**Margin of error** is the largest possible sampling error at the specified level of confidence:\n\n$$\n\\text{Margin of Err.} = \\text{Critical Val.} \\pm \\text{Std. Error}\n$$\n\n**Standard error** is the estimated value of the standard deviation of the sampling error. Keep in mind that standard errors are calculated on statistics while standard deviation is calculated on raw data.\n\n# Interval Estimation of $\\hat{p}$\n\nSampling distribution of $\\hat{p}$ plays a key role in computing the margin of error for the proportion interval estimate.\n\nSampling dist. of $\\hat{p}$ is approximately Normal whenever $np \\geq 5$ and $n(1 - p) \\geq 5$.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nfrom scipy.stats import t\nimport matplotlib.pyplot as plt\nfrom scipy.stats import norm\nimport numpy as np\n\nmean = 0\nsd = 1\nalpha = 0.05\n\nx = np.linspace(-4, 4, 1000)\n\ncrit_value = norm.ppf(1 - alpha / 2, loc=mean, scale=sd)\npdf = norm.pdf(x, loc=mean, scale=sd)\n\nplt.fill_between(x, pdf, where=(\n    x > crit_value), color='gray', alpha=0.3)\nplt.fill_between(x, pdf, where=(\n    x < -1 * crit_value), color='gray', alpha=0.3)\n\nplt.plot(x, pdf)\n```\n\n::: {.cell-output .cell-output-display}\n![Interval Estimation Critical Regions on Standard Normal, $\\alpha = 0.05$](index_files/figure-html/cell-2-output-1.png){width=579 height=411}\n:::\n:::\n\n\nWe can obtain our critical z-value through a two-tailed test computation which helps us calculate the confidence interval for $\\hat{p}$:\n\n$$\n\\hat{p} \\pm z_{\\alpha/2} \\sqrt{\\frac{\\hat{p}(1 - \\hat{p})}{n}}\n$$\n\n::: {.callout-tip}\n## Using the Standard Normal Table or Python\n\nWe can calculate the z-value needed through the Standard Normal table with the $\\alpha/2$ level of probability or in Python using $1 - \\frac{\\alpha}{2}$ and `norm.ppf` from `scipy`\n:::\n\nIf we look at the formula, then an increase in he sample size would result in a narrower confidence interval. Meanwhile, if we increase our confidence interval the confidence interval becomes wider.\n\n# Interval Estimation of $\\bar{x}$\n\nIn interval estimations of $\\bar{x}$ we don't know the standard deviation so we need to estimate with the sample standard deviation, $s$.\n\nWe are now estimating both $\\mu$ and $\\sigma$ so we have extra error. Normal distribution is no longer a good approximation so we need to use another distribution.\n\n## Student t Distribution\n\nThe t distribution is also symmetric, but has thicker tails than the Normal distribution.\n\nIt has $n - 1$ degrees of freedom where the degrees of freedom are the number of independent pieces of information that go into the computation of $s$.\n\nFor larger samples, the t distribution is approximately the standard Normal distribution.\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\nx = np.linspace(-4, 4, 100)\n\npdf = t.pdf(x, df=19)\nplt.plot(x, pdf)\n```\n\n::: {.cell-output .cell-output-display}\n![Plot of a t distribution with d.f. 19](index_files/figure-html/cell-3-output-1.png){width=579 height=411}\n:::\n:::\n\n\nThe confidence interval for $\\bar{x}$ is calculated as:\n\n$$\n\\bar{x} \\pm t_{\\alpha/2} \\cdot \\frac{s}{\\sqrt{n}}\n$$\n\nFor large samples ($n \\geq 50$) we can calculate the confidence interval for the mean from any population.\n\nFor small samples ($n < 50$) we need to assume the population follows a Normal distribution.\n\n# Sample Size Calculation\n\nTo calculate the sample size needed for a desired margin of error, we can calculate $n$ from the confidence interval formulas.\n\n$$\n\\begin{align*}\nE &= z_{\\alpha/2} \\sqrt{\\frac{\\hat{p}(1 - \\hat{p})}{n}} \\\\\n\\ \\\\\nn &= \\frac{(z_{\\alpha/2}^2)\\hat{p}(1 - \\hat{p})}{E^2}\n\\end{align*}\n$$\n\nSince $\\hat{p}$ depends on sample size, we typically use an estimate $p^* = 0.5$ as that will provide us the largest sample size for any true value of $\\hat{p}$.\n\nWhat about for sample mean $\\bar{x}$?\n\n$$\nn = \\frac{(z_{\\alpha/2}^2)s^{*2}}{E^2}\n$$\n\nWe don't know $s^2$ or the t-value ahead of sampling so we substitute with z-score and $s^{*2}$ using a pilot sample or previous information to get the value.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {}
  }
}