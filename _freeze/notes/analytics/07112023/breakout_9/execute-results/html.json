{
  "hash": "1610054b7d5b1d42d9bdfc8d31f5561e",
  "result": {
    "markdown": "---\ntitle: Breakout 9\ndate: 07/11/2023\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n✖ dplyr::recode() masks car::recode()\n✖ purrr::some()   masks car::some()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nglimpse(mtcars)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 32\nColumns: 11\n$ mpg  <dbl> 21.0, 21.0, 22.8, 21.4, 18.7, 18.1, 14.3, 24.4, 22.8, 19.2, 17.8,…\n$ cyl  <dbl> 6, 6, 4, 6, 8, 6, 8, 4, 4, 6, 6, 8, 8, 8, 8, 8, 8, 4, 4, 4, 4, 8,…\n$ disp <dbl> 160.0, 160.0, 108.0, 258.0, 360.0, 225.0, 360.0, 146.7, 140.8, 16…\n$ hp   <dbl> 110, 110, 93, 110, 175, 105, 245, 62, 95, 123, 123, 180, 180, 180…\n$ drat <dbl> 3.90, 3.90, 3.85, 3.08, 3.15, 2.76, 3.21, 3.69, 3.92, 3.92, 3.92,…\n$ wt   <dbl> 2.620, 2.875, 2.320, 3.215, 3.440, 3.460, 3.570, 3.190, 3.150, 3.…\n$ qsec <dbl> 16.46, 17.02, 18.61, 19.44, 17.02, 20.22, 15.84, 20.00, 22.90, 18…\n$ vs   <dbl> 0, 0, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0,…\n$ am   <dbl> 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0,…\n$ gear <dbl> 4, 4, 4, 3, 3, 3, 3, 4, 4, 4, 4, 3, 3, 3, 3, 3, 3, 4, 4, 4, 3, 3,…\n$ carb <dbl> 4, 4, 1, 1, 2, 1, 4, 2, 2, 4, 4, 3, 3, 3, 4, 4, 4, 1, 2, 1, 1, 2,…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm.model <- lm(mpg ~ ., data = mtcars)\nv <- vif(lm.model)\nv[v > 10]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     cyl     disp       wt \n15.37383 21.62024 15.16489 \n```\n:::\n\n```{.r .cell-code}\nwhich.min(abs(cor(mtcars)[\"mpg\", c(\"cyl\", \"disp\", \"wt\")]))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ndisp \n   2 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars.subset <- mtcars %>%\n    select(-disp)\n\nlm.model <- lm(mpg ~ ., data = mtcars.subset)\nv <- vif(lm.model)\nv[v > 10]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     cyl \n14.28474 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmtcars.subset <- mtcars.subset %>%\n    select(-cyl)\n\nlm.model <- lm(mpg ~ ., data = mtcars.subset)\nv <- vif(lm.model)\nv[v > 10]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nnamed numeric(0)\n```\n:::\n:::\n\n\n# Model Selection\n\n\n::: {.cell}\n\n```{.r .cell-code}\nempty.model <- lm(mpg ~ 1, data = mtcars.subset)\nfull.model <- lm(mpg ~ ., data = mtcars.subset)\n\nfor.model <- step(empty.model,\n    scope = list(\n        lower = empty.model,\n        upper = full.model\n    ),\n    direction = \"forward\",\n    k = 2,\n    trace = FALSE\n)\nsummary(for.model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = mpg ~ wt + hp + am + qsec, data = mtcars.subset)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-3.4975 -1.5902 -0.1122  1.1795  4.5404 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)   \n(Intercept) 17.44019    9.31887   1.871  0.07215 . \nwt          -3.23810    0.88990  -3.639  0.00114 **\nhp          -0.01765    0.01415  -1.247  0.22309   \nam           2.92550    1.39715   2.094  0.04579 * \nqsec         0.81060    0.43887   1.847  0.07573 . \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.435 on 27 degrees of freedom\nMultiple R-squared:  0.8579,\tAdjusted R-squared:  0.8368 \nF-statistic: 40.74 on 4 and 27 DF,  p-value: 4.589e-11\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(for.model, aes(sample = .resid)) +\n    stat_qq() +\n    stat_qq_line()\n```\n\n::: {.cell-output-display}\n![](breakout_9_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(resid(for.model))\n```\n\n::: {.cell-output-display}\n![](breakout_9_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(for.model, aes(x = .fitted, y = .resid)) +\n    geom_point() +\n    geom_line(y = 0)\n```\n\n::: {.cell-output-display}\n![](breakout_9_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n:::",
    "supporting": [
      "breakout_9_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}