{
  "hash": "9eb699d9f87f2bf767e01196c95bed80",
  "result": {
    "markdown": "# 1\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\ngarlic <- read.csv(\"https://raw.githubusercontent.com/IAA-Faculty/statistical_foundations/master/garlic.csv\")\nglimpse(garlic)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 32\nColumns: 3\n$ BedID      <int> 101, 102, 103, 104, 105, 106, 107, 108, 201, 202, 203, 204,…\n$ Fertilizer <int> 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3,…\n$ BulbWt     <dbl> 0.2391642, 0.2582814, 0.2047856, 0.2433666, 0.2726395, 0.21…\n```\n:::\n:::\n\n\n# 2\n\n## a\n\nVerifying normality:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarlic_lm <- lm(BulbWt ~ factor(Fertilizer), data = garlic)\nggplot(garlic, aes(x = BulbWt, fill = factor(Fertilizer))) +\n    geom_density(alpha = 0.2, position = \"identity\") +\n    labs(x = \"Bulb Weight\")\n```\n\n::: {.cell-output-display}\n![](lab_3_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n-   Groups do not appear to be Normally distributed\n\nVerifying equal variance:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfligner.test(BulbWt ~ factor(Fertilizer), data = garlic)$p.value\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.4744925\n```\n:::\n:::\n\n\n-   Through the Fligner test, we do not have enough evidence to claim that there are different variances\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkruskal.test(BulbWt ~ factor(Fertilizer), data = garlic)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  BulbWt by factor(Fertilizer)\nKruskal-Wallis chi-squared = 12.384, df = 3, p-value = 0.006178\n```\n:::\n:::\n\n\n-   Given the p-value, we believe that there is a significant difference in location. Values in one or more of the groups tend to be higher than others\n\n## b\n\n4 choose 2 so 6 tests\n\n## c\n\n\n::: {.cell}\n\n```{.r .cell-code}\n1 - (1 - 0.05)^6\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.2649081\n```\n:::\n:::\n\n\nWe solve this problem of experiment-wise error rate by using Tukey's Honest Significant Difference.\n\n## d\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngarlic_aov <- aov(BulbWt ~ factor(Fertilizer), data = garlic)\n\ntukey_garlic <- TukeyHSD(garlic_aov)\nprint(tukey_garlic)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = BulbWt ~ factor(Fertilizer), data = garlic)\n\n$`factor(Fertilizer)`\n            diff          lwr         upr     p adj\n2-1 -0.030285751 -0.076646102  0.01607460 0.3020823\n3-1  0.007007653 -0.039352697  0.05336800 0.9758350\n4-1 -0.061634930 -0.107995281 -0.01527458 0.0058337\n3-2  0.037293404 -0.009066947  0.08365375 0.1489779\n4-2 -0.031349179 -0.077709530  0.01501117 0.2737971\n4-3 -0.068642583 -0.115002934 -0.02228223 0.0020089\n```\n:::\n:::\n\n\n-   Fertilizers 4 and 1 as well as Fertilizers 4 and 3 are statistically different from each other. Pairs 2-1, 3-1, 3-2, 4-2 are not statistically different.\n\n# 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbottle <- read.csv(\"https://raw.githubusercontent.com/IAA-Faculty/statistical_foundations/master/bottle.csv\")\nglimpse(bottle)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 69\nColumns: 2\n$ Units <int> 37, 22, 26, 35, 27, 32, 27, 20, 19, 33, 21, 34, 14, 35, 25, 28, …\n$ Line  <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…\n```\n:::\n:::\n\n\nVerifying assumption of normality:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(bottle, aes(sample = Units, color = factor(Line))) +\n    stat_qq() +\n    stat_qq_line()\n```\n\n::: {.cell-output-display}\n![](lab_3_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n-   The groups are approximately Normal\n\nVerifying assumption of equal variances:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'car'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    some\n```\n:::\n\n```{.r .cell-code}\nleveneTest(Units ~ factor(Line), data = bottle)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLevene's Test for Homogeneity of Variance (center = median)\n      Df F value Pr(>F)\ngroup  2  0.5205 0.5967\n      66               \n```\n:::\n:::\n\n\n-   There is no evidence to say that the variances between the lines are different\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbottle_lm <- lm(Units ~ factor(Line), data = bottle)\n\nanova(bottle_lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: Units\n             Df Sum Sq Mean Sq F value    Pr(>F)    \nfactor(Line)  2 1033.2  516.62  12.111 3.308e-05 ***\nResiduals    66 2815.3   42.66                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n-   At least one of the lines has a significant difference in mean units produced\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTukeyHSD(aov(Units ~ factor(Line), data = bottle))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = Units ~ factor(Line), data = bottle)\n\n$`factor(Line)`\n         diff        lwr       upr     p adj\n2-1  2.521739  -2.096082  7.139560 0.3950814\n3-1 -6.652174 -11.269995 -2.034353 0.0027543\n3-2 -9.173913 -13.791734 -4.556092 0.0000320\n```\n:::\n:::\n\n\n-   We can confirm that 3 seems to be performing worse than 1 or 2 as there are statistical differences between the pairs \n\n# 4\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntrials <- read.csv(\"https://raw.githubusercontent.com/IAA-Faculty/statistical_foundations/master/trials.csv\")\nglimpse(trials)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 93\nColumns: 5\n$ Treatment  <chr> \"New Drug\", \"New Drug\", \"New Drug\", \"New Drug\", \"New Drug\",…\n$ Subject    <chr> \"N1\", \"N2\", \"N3\", \"N4\", \"N5\", \"N6\", \"N7\", \"N8\", \"N9\", \"N10\"…\n$ Age        <int> 68, 59, 60, 57, 58, 59, 69, 65, 59, 41, 65, 61, 64, 65, 70,…\n$ BaselineBP <dbl> 100.3, 91.6, 90.0, 93.7, 95.4, 99.6, 97.9, 96.0, 96.9, 95.4…\n$ BPChange   <dbl> -20.4, -5.7, -4.3, -7.9, -10.1, -16.4, -15.0, -11.1, -10.8,…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(trials, aes(sample = BPChange, color = Treatment)) +\n    stat_qq() +\n    stat_qq_line()\n```\n\n::: {.cell-output-display}\n![](lab_3_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nleveneTest(BPChange ~ factor(Treatment), data = trials)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLevene's Test for Homogeneity of Variance (center = median)\n      Df F value   Pr(>F)   \ngroup  2  7.4146 0.001045 **\n      90                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n-   Difference in variances\n\n\n::: {.cell}\n\n```{.r .cell-code}\noneway.test(BPChange ~ factor(Treatment), data = trials)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne-way analysis of means (not assuming equal variances)\n\ndata:  BPChange and factor(Treatment)\nF = 84.286, num df = 2.000, denom df = 50.396, p-value < 2.2e-16\n```\n:::\n:::\n\n\n-   Difference in means is significant\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTukeyHSD(aov(BPChange ~ factor(Treatment), data = trials))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = BPChange ~ factor(Treatment), data = trials)\n\n$`factor(Treatment)`\n                            diff       lwr       upr     p adj\nNew Drug-Approved Drug -7.448387 -9.491358 -5.405416 0.0000000\nPlacebo-Approved Drug   3.575758  1.562931  5.588584 0.0001625\nPlacebo-New Drug       11.024145  9.046180 13.002110 0.0000000\n```\n:::\n:::\n",
    "supporting": [
      "lab_3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}