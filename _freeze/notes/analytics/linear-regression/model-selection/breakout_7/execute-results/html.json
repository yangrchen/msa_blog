{
  "hash": "ca6bb4c860052035e634574db320ceeb",
  "result": {
    "markdown": "---\ntitle: Breakout 7\ndate: 07/07/2023\n---\n\n\n# 1\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.2     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nbike <- read.csv(\"https://raw.githubusercontent.com/IAA-Faculty/statistical_foundations/master/bike.csv\")\nglimpse(bike)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 17,379\nColumns: 16\n$ dteday     <int> 14975, 14975, 14975, 14975, 14975, 14975, 14975, 14975, 149…\n$ season     <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ yr         <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ mnth       <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…\n$ hr         <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 1…\n$ holiday    <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ weekday    <int> 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,…\n$ workingday <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ weathersit <int> 1, 1, 1, 1, 1, 2, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3,…\n$ temp       <dbl> 0.24, 0.22, 0.22, 0.24, 0.24, 0.24, 0.22, 0.20, 0.24, 0.32,…\n$ atemp      <dbl> 0.2879, 0.2727, 0.2727, 0.2879, 0.2879, 0.2576, 0.2727, 0.2…\n$ hum        <dbl> 0.81, 0.80, 0.80, 0.75, 0.75, 0.75, 0.80, 0.86, 0.75, 0.76,…\n$ windspeed  <dbl> 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0896, 0.0000, 0.0…\n$ casual     <int> 3, 8, 5, 3, 0, 0, 2, 1, 1, 8, 12, 26, 29, 47, 35, 40, 41, 1…\n$ registered <int> 13, 32, 27, 10, 1, 1, 0, 2, 7, 6, 24, 30, 55, 47, 71, 70, 5…\n$ cnt        <int> 16, 40, 32, 13, 1, 1, 2, 3, 8, 14, 36, 56, 84, 94, 106, 110…\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(18954)\nbike <- bike %>%\n    mutate(id = row_number()) %>%\n    select(-dteday)\n\ntrain <- sample_frac(bike, 0.7)\ntest <- anti_join(bike, train, by = \"id\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntrain <- train %>%\n    select(-id)\n\nfull.model <- lm(cnt ~ ., data = train)\nempty.model <- lm(cnt ~ 1, data = train)\n\ncor(train)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  season           yr          mnth            hr      holiday\nseason      1.0000000000 -0.017728740  0.8341892714  0.0007029716 -0.008004203\nyr         -0.0177287399  1.000000000 -0.0127230269  0.0015380450  0.009701818\nmnth        0.8341892714 -0.012723027  1.0000000000  0.0005688982  0.016990981\nhr          0.0007029716  0.001538045  0.0005688982  1.0000000000  0.005471284\nholiday    -0.0080042032  0.009701818  0.0169909807  0.0054712840  1.000000000\nweekday    -0.0005697724  0.001429914  0.0107269128 -0.0014009498 -0.103965916\nworkingday  0.0165320138 -0.008277955  0.0017000694 -0.0005299508 -0.251746297\nweathersit -0.0151361998 -0.017434710  0.0054373800 -0.0187000757 -0.022398585\ntemp        0.3127250206  0.044994421  0.2027039404  0.1373762513 -0.022839374\natemp       0.3206906241  0.043824690  0.2093992596  0.1329508772 -0.027588827\nhum         0.1566301682 -0.078213509  0.1672219767 -0.2791132639 -0.012661765\nwindspeed  -0.1583175184 -0.011899846 -0.1395026596  0.1423059728 -0.001187728\ncasual      0.1200666387  0.139655612  0.0678288263  0.3015976700  0.029554121\nregistered  0.1732086022  0.251636065  0.1214334433  0.3750279189 -0.044113763\ncnt         0.1771539640  0.247838770  0.1197199984  0.3949779016 -0.028641358\n                 weekday    workingday   weathersit          temp        atemp\nseason     -0.0005697724  0.0165320138 -0.015136200  0.3127250206  0.320690624\nyr          0.0014299143 -0.0082779549 -0.017434710  0.0449944213  0.043824690\nmnth        0.0107269128  0.0017000694  0.005437380  0.2027039404  0.209399260\nhr         -0.0014009498 -0.0005299508 -0.018700076  0.1373762513  0.132950877\nholiday    -0.1039659165 -0.2517462966 -0.022398585 -0.0228393738 -0.027588827\nweekday     1.0000000000  0.0440390626  0.002079925 -0.0002332587 -0.006308329\nworkingday  0.0440390626  1.0000000000  0.046345654  0.0503730352  0.050603957\nweathersit  0.0020799250  0.0463456539  1.000000000 -0.1107357489 -0.113473368\ntemp       -0.0002332587  0.0503730352 -0.110735749  1.0000000000  0.988793611\natemp      -0.0063083285  0.0506039568 -0.113473368  0.9887936108  1.000000000\nhum        -0.0423660688  0.0171985675  0.418553933 -0.0711446535 -0.053368085\nwindspeed   0.0085516606 -0.0086861227  0.026242630 -0.0238094722 -0.062370548\ncasual      0.0247987465 -0.3092849530 -0.157273847  0.4601798782  0.456775438\nregistered  0.0261143092  0.1312660111 -0.127020760  0.3366572816  0.335080666\ncnt         0.0285440726  0.0245754369 -0.148882272  0.4064747925  0.404228875\n                   hum    windspeed      casual  registered         cnt\nseason      0.15663017 -0.158317518  0.12006664  0.17320860  0.17715396\nyr         -0.07821351 -0.011899846  0.13965561  0.25163607  0.24783877\nmnth        0.16722198 -0.139502660  0.06782883  0.12143344  0.11972000\nhr         -0.27911326  0.142305973  0.30159767  0.37502792  0.39497790\nholiday    -0.01266176 -0.001187728  0.02955412 -0.04411376 -0.02864136\nweekday    -0.04236607  0.008551661  0.02479875  0.02611431  0.02854407\nworkingday  0.01719857 -0.008686123 -0.30928495  0.13126601  0.02457544\nweathersit  0.41855393  0.026242630 -0.15727385 -0.12702076 -0.14888227\ntemp       -0.07114465 -0.023809472  0.46017988  0.33665728  0.40647479\natemp      -0.05336809 -0.062370548  0.45677544  0.33508067  0.40422887\nhum         1.00000000 -0.295339230 -0.34747646 -0.27486663 -0.32413130\nwindspeed  -0.29533923  1.000000000  0.08710282  0.07999503  0.09048990\ncasual     -0.34747646  0.087102823  1.00000000  0.50678257  0.69607810\nregistered -0.27486663  0.079995030  0.50678257  1.00000000  0.97170007\ncnt        -0.32413130  0.090489897  0.69607810  0.97170007  1.00000000\n```\n:::\n\n```{.r .cell-code}\nfor.model <- step(empty.model,\n    scope = list(\n        lower = empty.model,\n        upper = full.model\n    ), direction = \"forward\", k = 2, trace = FALSE\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: attempting model selection on an essentially perfect fit is nonsense\n\nWarning: attempting model selection on an essentially perfect fit is nonsense\n\nWarning: attempting model selection on an essentially perfect fit is nonsense\n\nWarning: attempting model selection on an essentially perfect fit is nonsense\n\nWarning: attempting model selection on an essentially perfect fit is nonsense\n\nWarning: attempting model selection on an essentially perfect fit is nonsense\n```\n:::\n\n```{.r .cell-code}\nfor.model\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = cnt ~ registered + casual + workingday + hum + season + \n    weathersit + weekday, data = train)\n\nCoefficients:\n(Intercept)   registered       casual   workingday          hum       season  \n  1.417e-12    1.000e+00    1.000e+00   -5.752e-14   -1.960e-13    2.421e-14  \n weathersit      weekday  \n  3.765e-14    9.453e-15  \n```\n:::\n:::\n\n\n# 2\n\n::: {.cell}\n\n```{.r .cell-code}\ntrain <- train %>%\n    select(-c(casual, registered))\n\nfull.model <- lm(cnt ~ ., data = train)\nempty.model <- lm(cnt ~ 1, data = train)\n\nfor.model <- step(empty.model,\n    scope = list(\n        lower = empty.model,\n        upper = full.model\n    ), direction = \"forward\", k = 2, trace = FALSE\n)\nfor.model\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = cnt ~ temp + hr + yr + hum + season + atemp + holiday + \n    windspeed + weekday + weathersit, data = train)\n\nCoefficients:\n(Intercept)         temp           hr           yr          hum       season  \n    -22.084       13.217        7.669       80.195     -201.396       19.819  \n      atemp      holiday    windspeed      weekday   weathersit  \n    312.098      -26.051       39.301        1.701       -4.288  \n```\n:::\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}